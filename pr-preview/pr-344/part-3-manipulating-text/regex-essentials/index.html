<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-manipulating-text/regex-essentials/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Regex Essentials | Effective Shell</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://effective-shell.com/part-3-manipulating-text/regex-essentials/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="ca-pub-6181461532532600"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Regex Essentials | Effective Shell"><meta data-rh="true" name="description" content="Many of the tools we&#x27;re going to introduce in this part of the book support regular expressions or regexes - a sophisticated language which allows us to describe different patterns of text."><meta data-rh="true" property="og:description" content="Many of the tools we&#x27;re going to introduce in this part of the book support regular expressions or regexes - a sophisticated language which allows us to describe different patterns of text."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://effective-shell.com/part-3-manipulating-text/regex-essentials/"><link data-rh="true" rel="alternate" href="https://effective-shell.com/part-3-manipulating-text/regex-essentials/" hreflang="en"><link data-rh="true" rel="alternate" href="https://effective-shell.com/part-3-manipulating-text/regex-essentials/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8HZFMZV9Z4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8HZFMZV9Z4",{anonymize_ip:!0})</script>


<script src="https://cdn.jsdelivr.net/npm/docusaurus-plugin-drawio/viewer.min.js"></script>


<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6181461532532600" async></script>
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6181461532532600" async></script><link rel="stylesheet" href="/assets/css/styles.51892cac.css">
<link rel="preload" href="/assets/js/runtime~main.5430b760.js" as="script">
<link rel="preload" href="/assets/js/main.ca0d9daf.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Effective Shell Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Effective Shell Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Effective Shell</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/donate">Donate</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div><a href="https://github.com/dwmkerr/effective-shell/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/part-1-transitioning-to-the-shell/">Transitioning to the Shell</a><button aria-label="Toggle the collapsible sidebar category &#x27;Transitioning to the Shell&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/part-2-core-skill/">Core Skills</a><button aria-label="Toggle the collapsible sidebar category &#x27;Core Skills&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/part-3-manipulating-text/">Manipulating Text and Streams</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manipulating Text and Streams&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/part-3-manipulating-text/regex-essentials/">Regex Essentials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/part-3-manipulating-text/get-to-grips-with-grep/">Get to Grips with Grep</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/part-3-manipulating-text/slice-and-dice-text/">Slice and Dice Text</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/part-3-manipulating-text/advanced-text-manipulation/">Advanced Text Manipulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/part-3-manipulating-text/build-commands-on-the-fly/">Build Commands on the Fly</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/part-4-shell-scripting/">Shell Scripting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shell Scripting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/part-5-building-your-toolkit/">Building Your Toolkit</a><button aria-label="Toggle the collapsible sidebar category &#x27;Building Your Toolkit&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/part-6-advanced-techniques/">Advanced Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/xx-appendices/installing-samples/">Appendices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zz-developer-guide/components">Developer Guide</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Regex Essentials</h1></header><p>Many of the tools we&#x27;re going to introduce in this part of the book support <em>regular expressions</em> or regexes - a sophisticated language which allows us to describe different patterns of text.</p><p>Before we look at how to use regular expressions in the shell, it is important to understand some of the basic regular expression concepts and techniques. This chapter covers the essentials - if you are already familiar with regular expressions feel free to skip to the next chapter.</p><p>In this chapter we&#x27;ll look at why regular expressions can be intimidating, how to manage complexity and not overwhelm yourself, some of the core concepts in regular expressions and a few things to watch out for. Once we&#x27;ve seen the theory we&#x27;ll be able to apply it in practice in the following chapters!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="an-introduction-to-regular-expressions">An Introduction to Regular Expressions<a class="hash-link" href="#an-introduction-to-regular-expressions" title="Direct link to heading">â€‹</a></h2><p>Regular Expressions (or <em>regexs</em>) are special &#x27;patterns&#x27; which describe text. They are infamous (or even notorious) amongst technologists as being complex and opaque. For many years I avoided regular expressions as I found them overly complicated and hard to reason about. But over time I discovered that used carefully, they can be incredibly powerful and useful.</p><p>It is no surprise that regular expressions can be seen as opaque. Let&#x27;s say we wanted to find a way to see whether an arbitrary string matches the structure of a valid email address. A quick search on the internet will find a regular expression such as this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(?:[a-z0-9!#$%&amp;&#x27;*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;&#x27;*+/=?^_`{|}~-]+)*|&quot;(?:[\x01-\x08</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*&quot;)@(?:(?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that I have split the expression into multiple lines so that it fits on the page.</p><p>This is <em>horrendously</em> complex. It is extremely long, almost impossible for even an experienced user to parse or reason about, and attempting to change or modify it would be very risky.</p><p>Many people see examples like the above and decide (probably quite sensibly) that regular expressions are something they just simply will not learn - they&#x27;re too complex.</p><p>So should we learn regular expressions? Are they even valuable if they are as complex as the example above?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="managing-complexity-with-regular-expressions">Managing Complexity with Regular Expressions<a class="hash-link" href="#managing-complexity-with-regular-expressions" title="Direct link to heading">â€‹</a></h2><p>Regular expressions do not have to be as complex as the example above. In fact, in most cases they shouldn&#x27;t be. My general advice for regular expressions is <em>start simple</em> and add complexity only if you need it.</p><p>We can build regular expressions using an &#x27;iterative&#x27; process, starting with the basics, then adding more features as we need them. An invaluable tool I have used for this is the website <a href="https://regex101.com" target="_blank" rel="noopener noreferrer">regex101.com</a>. This website not only lets you test regular expressions, it also breaks down how they work so that you can reason about what is happening.</p><p>Let&#x27;s take validating an email address as an example. The way I would build a regular expression to validate an email address would be to use the following steps:</p><ol><li>Create a small list of valid email address</li><li>Add some items to the list which look &#x27;kind of&#x27; valid but are not quite right</li><li>Build a regular expression which matches the correct email address</li><li>Refine the expression to eliminate the invalid addresses</li></ol><p>In most cases this will be sufficient.</p><p>Let&#x27;s start with the following set of addresses:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dave@effective-shell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dave@effective-shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">to: dave@effective-shell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dave@effective-shell.com &lt;Dave Kerr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test123.effective-shell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@yahoo.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">whatever123@ðŸ˜‚.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dave@kerr@effective.shell.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Some are valid, some are not. Some you might not be sure about - such as the one with the emoji. This one is valid if someone sets up a mail server which can handle it, but probably not a good address to use as some mail programs or servers will reject it (Gmail for example, at time of writing, would allow you to send and receive from an email address like this, but not create an email address like this).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---start-with-the-basics">Building Regexes - Start with the Basics<a class="hash-link" href="#building-regexes---start-with-the-basics" title="Direct link to heading">â€‹</a></h3><p>Here&#x27;s how I would start building a regex for an email address:</p><ol><li>Any set of characters</li><li>Followed by an <code>@</code> at symbol</li><li>Followed by any set of characters</li></ol><p>That regex would look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.*@.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first bit, <code>.*</code> means &#x27;any character&#x27; (this is what the <code>.</code> dot symbol means), &#x27;any number of times (this is what the <code>*</code> asterisk symbol means).</p><p>The second bit is just the literal <code>@</code> at symbol character.</p><p>The third bit is the same as the first - any characters any number of times.</p><p>Let&#x27;s see how that would look in <a href="https://regex101.com" target="_blank" rel="noopener noreferrer">regex101</a>:</p><img loading="lazy" src="/assets/images/regex_v1-f91163e62ea21c34e399180ea629e8b3.png" alt="Regular Expression Example 1" width="1024px" class="img_ev3q"><p>Here we can see in blue the lines that the regex has matched. We can also see which part of each line corresponds to which part of the expression. But perhaps the most useful thing we see is the &#x27;explanation&#x27; on the right which explains exactly what each character does.</p><p>Now that we have a basic pattern which matches the valid address, we can refine it to eliminate invalid addresses.</p><p>Note that from this point onwards we&#x27;ll not show screenshots of the results as you would see them in the regex101 website, instead we&#x27;ll just highlight the matched part of the text in <strong>bold</strong>, this should make it easier to read. But to see a breakdown of how each part of the text is matched and what each part of the pattern means, feel free to run the examples in the regex101 website!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---quantifiers">Building Regexes - Quantifiers<a class="hash-link" href="#building-regexes---quantifiers" title="Direct link to heading">â€‹</a></h3><p>The regular expression we have is very simple - <code>.*@.*</code>. The complexity in regular expressions tends to come from the fact that we need to handle &#x27;edge cases&#x27; and be very explicit about what we can and cannot allow.</p><p>Let&#x27;s see how we can refine this expression further to eliminate some of the invalid addresses. Let&#x27;s start with <code>@yahoo.com</code>. It doesn&#x27;t have anything before the at symbol.</p><p>This is being matched by our pattern because our pattern allows any characters before and after the at symbol <em>any number of times</em> - including <em>zero times</em>.</p><p>Let&#x27;s change number of characters before and after the at symbol to be &#x27;between one and many&#x27;. To do this we use a different <em>quantifier</em> (a &#x27;quantifier&#x27; is the part of a pattern which says &#x27;how many occurrences of the characters do we expect).</p><p>Previously we used the <code>*</code> asterisk quantifier (which means &#x27;any number of times&#x27;). Now we&#x27;ll use the <code>+</code> plus quantifier (which means &#x27;at least one time&#x27;). Let&#x27;s see how it looks:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">.+@.+<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<strong>to: dave@effective-shell.com</strong>
<strong>dave@effective-shell.com &lt;Dave Kerr&gt;</strong>
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<strong>whatever123@ðŸ˜‚.com</strong>
<strong>dave@kerr@effective.shell.com</strong>
</code></pre><p>This is better - we&#x27;ve eliminated some invalid addresses, <code>test123.effective-shell.com</code>, <code>@yahoo.com</code> and <code>dave@</code>.</p><p>We have introduced a key concept - the <em>quantifier</em>. The quantifier we have used is the <code>+</code> plus symbol. This is the part of a regular expression which says &#x27;how many times can a character be matched?&#x27;.</p><p>There are a few different quantifiers, here is a quick reference:</p><table><thead><tr><th>Quantifier</th><th>Meaning</th></tr></thead><tbody><tr><td><code>*</code></td><td>Any number of characters.</td></tr><tr><td><code>+</code></td><td>At least one character.</td></tr><tr><td><code>?</code></td><td>Between zero and one character.</td></tr><tr><td><code>{10}</code></td><td>Exactly ten occurrences of the character.</td></tr><tr><td><code>{10,}</code></td><td>Ten or more occurrences of the character.</td></tr><tr><td><code>{10,20}</code></td><td>Between ten and twenty occurrences of the character.</td></tr></tbody></table><p>Now let&#x27;s look at the character itself.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---character-sets-and-metacharacters">Building Regexes - Character Sets and Metacharacters<a class="hash-link" href="#building-regexes---character-sets-and-metacharacters" title="Direct link to heading">â€‹</a></h3><p>When we are matching text, we match a set of characters a number of times. The set of characters we match can be a <em>character set</em> (which is when we explicitly say what is allowed), or a <em>metacharacter</em> (which is a predefined character set). This concept is far easier to explain with an example.</p><p>Let&#x27;s look at the address <code>dave@kerr@effective.shell.com</code>. This is clearly invalid, it has two at symbols. We can use character sets or metacharacters to fix this.</p><p>The reason this address matches our expressions is that we are using the <code>.</code> dot <em>metacharacter</em> before and after the at symbol. The dot metacharacter means &#x27;any character&#x27; (except a newline). This <em>includes</em> the at symbol character.</p><p>There are a few ways we would be more explicit. Let&#x27;s look at each of them, as each one will show a character set or metacharacter in detail.</p><p><strong>Character Sets - Ranges</strong></p><p>A character set starts and ends with square brackets. We can use letters or numbers with a hyphen in-between to denote a range of characters for the character set. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[A-Za-z0-9]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This character set matches any of the letters A to Z (uppercase) or a-z (lowercase) or the digits 0-9. Let&#x27;s see how it looks with the pattern:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">[A-Za-z0-9]+@[A-Za-z0-9]+<!-- -->
<!-- -->
<strong>dave@effective</strong>-shell.com<!-- -->
<strong>dave@effective</strong>-shell<!-- -->
<!-- -->to: <strong>dave@effective-shell</strong>.com<!-- -->
<strong>dave@effective</strong>-shell.com &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<!-- -->whatever123@ðŸ˜‚.com<!-- -->
<strong>dave@kerr</strong>@effective.shell.com<!-- -->
</code></pre><p>This fails to match the valid email address <code>dave@effective-shell.com</code> - because it has a hyphen after the at symbol, and the hyphen character is not in our character set. It also fails to match others for the same reason - we haven&#x27;t got the &#x27;dot&#x27; character in our character set.</p><p>Let&#x27;s see how we can do better.</p><p><strong>Character Sets - Special Characters</strong></p><p>We can add more characters to our character set. To include the dot and the hyphen, we just add them directly to the set:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[A-Za-z0-9-.]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That&#x27;s all there is to it! We can now see our pattern is more correct:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">[A-Za-z0-9-.]+@[A-Za-z0-9-.]+<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<!-- -->to: <strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell.com</strong> &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<!-- -->whatever123@ðŸ˜‚.com<!-- -->
<strong>dave@kerr</strong>@effective.shell.com<!-- -->
</code></pre><p>However, the expression is getting larger and larger. We can use a <em>metacharacter</em> instead of the character range to make it easier to read. A metacharacter is a special character which is used to represent a range of characters. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\w+@\w+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">\w+@\w+<!-- -->
<!-- -->
<strong>dave@effective</strong>-shell.com<!-- -->
<strong>dave@effective</strong>-shell<!-- -->
<!-- -->to: <strong>dave@effective-shell</strong>.com<!-- -->
<strong>dave@effective</strong>-shell.com &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<!-- -->whatever123@ðŸ˜‚.com<!-- -->
<strong>dave@kerr</strong>@effective.shell.com<!-- -->
</code></pre><p>The uses the &#x27;word&#x27; metacharacter, <code>\w</code>. This is just a shorthand for <code>[a-zA-Z0-9_]</code>. But now our pattern fails again as the <code>\w</code> metacharacter doesn&#x27;t include the hyphen or the dot. We can fix this easily - a <em>character set</em> can include metacharacters! So we can just combine <code>\w</code> and the hyphen and dot:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">[\w+-.]+@[\w+-.]+<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<!-- -->to: <strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell.com</strong> &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<!-- -->whatever123@ðŸ˜‚.com<!-- -->
<strong>dave@kerr</strong>@effective.shell.com<!-- -->
</code></pre><p><strong>Character Sets - Negating Characters</strong></p><p>We can use the <code>^</code> circumflex symbol to <em>negate</em> a character. This allows us to build a character set which <em>doesn&#x27;t</em> match a pattern. For example, we could rewrite our pattern like this:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">[\S^@]+@[\S^@]+<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<!-- -->to: <strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell.com</strong> &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<strong>whatever123@ðŸ˜‚.com</strong>
<strong>dave@kerr@effective.shell.com</strong>
</code></pre><p>We&#x27;ve used the character set <code>[\S^@]</code> which means &#x27;any none-whitespace character&#x27; (this is the <code>\S</code> part) and &#x27;not the at symbol character&#x27; (this is the <code>^@</code> part).</p><p>Notice that in this case we have more matches - because the set of characters we are using is larger than a set such as <code>\w</code>. This expression now covers the email address with the emoji, because the emoji is not a whitespace character or an at symbol.</p><p><strong>Character Sets - Escaping Characters</strong></p><p>What do you do if you actually want to use the circumflex symbol in a character set? Just escape it! This means you put a slash first, the regex will then treat the character which follows the slash as a literal character. This is how we can match special characters like square brackets.</p><p>Here&#x27;s an example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[\[\]]+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This matches square brackets between one and many times.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[\^]\+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This matches the circumflex followed by the plus sign. If there is ever a point at which you need to use a special character in a regular expression as a <em>literal</em> character, escape it by putting a slash in front of it.</p><p><strong>Character Sets - Quick Reference</strong></p><p>We&#x27;ve seen quite a few character sets and metacharacters, here&#x27;s a quick reference for some commonly used ones:</p><table><thead><tr><th>Quantifier</th><th>Meaning</th></tr></thead><tbody><tr><td><code>.</code></td><td>Any character except for a line break.</td></tr><tr><td><code>\w</code></td><td>Any &#x27;word&#x27; character, <code>[a-zA-Z0-9_]</code>.</td></tr><tr><td><code>\W</code></td><td>Any non &#x27;word&#x27; character.</td></tr><tr><td><code>\s</code></td><td>Any &#x27;whitespace&#x27; character (space, tab, etc).</td></tr><tr><td><code>\S</code></td><td>Any non &#x27;whitespace&#x27; character.</td></tr><tr><td><code>\d</code></td><td>Any &#x27;digit&#x27; character <code>[0-9]</code>.</td></tr><tr><td><code>\D</code></td><td>Any non &#x27;digit&#x27; character.</td></tr></tbody></table><p>There are many other metacharacters, you can find more in the manpage <code>man re_pattern</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---anchors">Building Regexes - Anchors<a class="hash-link" href="#building-regexes---anchors" title="Direct link to heading">â€‹</a></h3><p>At the moment, if we use the expression below:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">[\S^@]+@[\S^@]+<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<!-- -->to: <strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell.com</strong> &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<strong>whatever123@ðŸ˜‚.com</strong>
<strong>dave@kerr@effective.shell.com</strong>
</code></pre><p>Then we match any line which <em>contains</em> an email address. But what if we only want to match complete email addresses? What if we need to exclude lines which have extra stuff at the beginning or end?</p><p>For this, we can use <em>anchors</em>. Anchors represent special parts of a string, such as the start or beginning of a line.</p><p>If we want to only match lines which contain a complete email address, we can use the <code>^</code> circumflex (start of line) anchor and <code>$</code> dollar (end of line) anchor:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">^[\S^@]+@[\S^@]+$<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
<strong>dave@effective-shell</strong>
<!-- -->to: dave@effective-shell.com<!-- -->
<!-- -->dave@effective-shell.com &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<strong>whatever123@ðŸ˜‚.com</strong>
<strong>dave@kerr@effective.shell.com</strong>
</code></pre><p>This allows us to create expressions which match patterns of text at certain points - anchors. For example, if we want to match any line which <em>starts with</em> the letters <code>to: </code> we could just use this:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">^to: .* <!-- -->
<!-- -->
<!-- -->dave@effective-shell.com<!-- -->
<!-- -->dave@effective-shell<!-- -->
<strong>to: dave@effective-shell.com</strong>
<!-- -->dave@effective-shell.com &lt;Dave Kerr&gt;<!-- -->
<!-- -->test123.effective-shell.com<!-- -->
<!-- -->@yahoo.com<!-- -->
<!-- -->dave@<!-- -->
<strong>whatever123@ðŸ˜‚.com</strong>
<strong>dave@kerr@effective.shell.com</strong>
</code></pre><p>You will see the start of line and end of line anchors quite often, they can be extremely useful when making a regular expression more specific.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---capture-groups">Building Regexes - Capture Groups<a class="hash-link" href="#building-regexes---capture-groups" title="Direct link to heading">â€‹</a></h3><p>You can extract only <em>part</em> of what you match in a regular expression using <em>capture groups</em>. A capture group lets you break up the expression into smaller parts and then operate on either the entire match, or only one of the groups.</p><p>Here&#x27;s an example:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">(.+)@(.+)<!-- -->
<!-- -->
<strong>dave@effective-shell.com</strong>
</code></pre><p>Now the entire line matches, but everything surrounded by <code>()</code> parentheses is a capture group. This means that the regular expression has actually made <em>three</em> matches:</p><ol><li><code>dave@effective-shell.com</code> - The first match in an expression is always the complete match</li><li><code>dave</code> - This is the first capture group, everything before the at symbol</li><li><code>effective-shell.com</code> - This is the second capture group, everything after the at symbol.</li></ol><p>We&#x27;re actually going to see how to use capture groups directly in the shell in the next chapter so we won&#x27;t go into much more detail now.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="building-regexes---lazy-and-greedy-expressions">Building Regexes - Lazy and Greedy Expressions<a class="hash-link" href="#building-regexes---lazy-and-greedy-expressions" title="Direct link to heading">â€‹</a></h3><p>Regular expressions can be <em>lazy</em> or <em>greedy</em>. Whether an expression is lazy or greedy affects how it matches patterns - basically whether it <em>stops</em> at the earliest point the pattern is matched, or <em>continues</em> until the pattern no longer matches.</p><p>Regular expressions are <em>greedy</em> by default. This means that if you are matching a pattern, the regular expression will capture as much as it possibly can - all the way to the last match. As an example, let&#x27;s look at how we might capture the contents of an html tag:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">&lt;.+&gt;<!-- -->
<!-- -->
<!-- -->This text is <strong>&lt;strong&gt;bold&lt;/strong&gt;</strong>.<!-- -->
</code></pre><p>The regular expression <code>&lt;.+&gt;</code> matches an angled bracket, then at least one character, then a closing angled bracket. Because regular expressions are greedy by default, it captures all the way until the <em>last angled bracket on the line</em> - i.e. everything up until the closing <code>&lt;/strong&gt;</code> tag.</p><p>We can create a <em>lazy</em> expression by using the <code>?</code> question mark symbol after the quantifier - this means that the expression will capture as few characters as possible until the end of the pattern is found:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">&lt;.+?&gt;<!-- -->
<!-- -->
<!-- -->This text is <strong>&lt;strong&gt;</strong>bold<strong>&lt;/strong&gt;</strong>.<!-- -->
</code></pre><p>In this example we have actually captured <em>two</em> results - the contents of the opening and closing tag. Because the expression <code>&lt;.+?&gt;</code> is <em>lazy</em> it matches only until the first closing brace it finds, meaning that the results are quite different.</p><p>To get the same results without using the lazy quantifier, we&#x27;d have to have an expression like this:</p><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv">&lt;[^&gt;]+&gt;<!-- -->
<!-- -->
<!-- -->This text is <strong>&lt;strong&gt;</strong>bold<strong>&lt;/strong&gt;</strong>.<!-- -->
</code></pre><p>In this case we&#x27;ve changed the match to &#x27;any character which is not a closing brace&#x27;. Whether this is easier for the reader to understand than the lazy quantifier is hard to say, but it is useful to understand the difference between lazy and greedy expressions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="avoiding-advanced-topics---backtracking-lookarounds-and-atomic-grouping">Avoiding Advanced Topics - Backtracking, Lookarounds and Atomic Grouping<a class="hash-link" href="#avoiding-advanced-topics---backtracking-lookarounds-and-atomic-grouping" title="Direct link to heading">â€‹</a></h2><p>I think that if you have the basics of quantifiers, character sets and metacharacters and capture groups, then you are probably well equipped to use regular expressions. Knowing how to make an expression lazy can also make working with regexes more straightforward.</p><p>However - you might come across a few terms when you are working with regular expressions which may be unfamiliar. These relate to perhaps more advanced topics. I&#x27;ll give brief overview here, but if you have had your fill of regexes for now then you can safely skip to the next section!</p><p>I am not going to show examples of each of these concepts. I&#x27;ll explain why after a brief summary of the concepts.</p><p><strong>Backtracking</strong> - this refers to the process a regular expression engine goes through to try and identify a greedy match. In short, it is possible to inadvertently write a regular expression which has exponential processing complexity based on the length of the input string.</p><p>This has led to cases of what is called &#x27;catastrophic backtracking&#x27; - where the processing involved to match a pattern can cause system failures or even lead to exploits<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>.</p><p>In short - very broad and greedy expressions such as <code>.+</code> (match <em>anything</em> at least once) may be susceptible to this problem. Be careful when writing your expressions to test them with short and long strings to see if there&#x27;s a noticeable performance difference. Regex101 and other tools can show you if your expression is time consuming. Avoid this by making expressions lazy when you can and matching more explicit characters.</p><p><strong>Lookarounds</strong> are special constructs which allow you to essentially say
&quot;find me a pattern, but only if it comes before or after another pattern&quot;. A lookahead is used to say &quot;find me a pattern, but only match it if it comes before another pattern&quot;, a lookbehind says &quot;find me a pattern, but only match it if it comes after another pattern&quot;. There are &#x27;negative&#x27; lookaheads and lookbehinds which essentially say &quot;find me a pattern which is <em>not</em> preceded or followed by another pattern&quot;.</p><p>As an example, the expression <code>\d+(?=â‚¬)</code> matches digits (this is the <code>\d</code> metacharacter), at least one or more (this is the <code>+</code> plus symbol), but only if the digits are followed by a Euro symbol. In this case the <code>(?=â‚¬)</code> part of the pattern is a &#x27;positive lookahead&#x27;.</p><p>I have not yet found a situation where I&#x27;ve really needed lookaround expressions. For example, I would simply write the above expression as:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(\d+)â‚¬</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which simply matches digits which precede a Euro symbol and puts them in a capture group.</p><p><strong>Atomic Groups</strong> are a more advanced construct which can be used to avoid backtracking which is described above. Lookarounds are atomic. Essentially when an atomic group is matched all backtracking ceases, so can provide a &#x27;get out&#x27; clause to avoid catastrophic backtracking.</p><p>This is somewhat opinionated, but in my years of engineering I am yet to find a situation which genuinely was made more simple with the use of lookarounds or atomic groups. I would instead advise that if your expression is highly complex, find a way to <em>break up the input</em> first and then process it in multiple steps. That will likely lead to scripts and code which is easier for others to read and reason about.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-word-of-warning">A Word of Warning<a class="hash-link" href="#a-word-of-warning" title="Direct link to heading">â€‹</a></h2><p>Different tools process regular expressions in different ways. There are subtle differences between how they are processed in Bash, JavaScript, Perl, Python, Golang and other languages. This can make them painful to work with.</p><p>In general most of the features we&#x27;ve seen in this chapter will work the same regardless of the tool you are using, but as you move into more sophisticated features, you may find that some tools have slightly different syntaxes for certain types of capture groups. However, this generally only affects the more advanced features such as named capture groups (which is a special syntax allowing you to give capture groups a descriptive name).</p><p>I would advise that you keep expressions simple if possible - if they are getting too complex then break up your input or break up the processing into smaller chunks of work!</p><p>Remember that a regular expression does not have to be the only way you validate input. You might use a regular expression to do a quick check on a form on a website to make sure that an email address has at least the correct <em>structure</em>, but you might then use a more sophisticated check later on (such as sending the user an activation email) to actually confirm that the address actually belongs to the user.</p><p>Using a website like regex101 you can quickly check how a regex works with different tools. Wherever you might encounter these differences in content in this book I&#x27;ve tried to call it out!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">â€‹</a></h2><p>Hopefully this gives a basic grounding in the fundamentals of regular expressions. Knowing only a few concepts - types of characters, quantifiers and capture groups is plenty for most people. And the online tool regex101 is a superb way to <em>learn</em> regular expressions.</p><p>Now we&#x27;ve learned the theory - in the next chapter we&#x27;ll see some built-in ways to manipulate text in the shell, which include some clever regular expression features.</p><div class="footnotes"><hr><ol><li id="fn-1">There is a fascinating write up of how this led to a severe Cloudflare outage in 2019 available online at: <a href="https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/" target="_blank" rel="noopener noreferrer">https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/</a><a href="#fnref-1" class="footnote-backref">â†©</a></li></ol></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dwmkerr/effective-shell/edit/main/docs/03-manipulating-text/13-regex-essentials/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/part-3-manipulating-text/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Part 3 - Manipulating Text and Streams</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/part-3-manipulating-text/get-to-grips-with-grep/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Get to Grips with Grep</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#an-introduction-to-regular-expressions" class="table-of-contents__link toc-highlight">An Introduction to Regular Expressions</a></li><li><a href="#managing-complexity-with-regular-expressions" class="table-of-contents__link toc-highlight">Managing Complexity with Regular Expressions</a><ul><li><a href="#building-regexes---start-with-the-basics" class="table-of-contents__link toc-highlight">Building Regexes - Start with the Basics</a></li><li><a href="#building-regexes---quantifiers" class="table-of-contents__link toc-highlight">Building Regexes - Quantifiers</a></li><li><a href="#building-regexes---character-sets-and-metacharacters" class="table-of-contents__link toc-highlight">Building Regexes - Character Sets and Metacharacters</a></li><li><a href="#building-regexes---anchors" class="table-of-contents__link toc-highlight">Building Regexes - Anchors</a></li><li><a href="#building-regexes---capture-groups" class="table-of-contents__link toc-highlight">Building Regexes - Capture Groups</a></li><li><a href="#building-regexes---lazy-and-greedy-expressions" class="table-of-contents__link toc-highlight">Building Regexes - Lazy and Greedy Expressions</a></li></ul></li><li><a href="#avoiding-advanced-topics---backtracking-lookarounds-and-atomic-grouping" class="table-of-contents__link toc-highlight">Avoiding Advanced Topics - Backtracking, Lookarounds and Atomic Grouping</a></li><li><a href="#a-word-of-warning" class="table-of-contents__link toc-highlight">A Word of Warning</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Effective Shell</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/donate">Donate</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/dwmkerr/effective-shell" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dwmkerr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Effective Shell v0.34.8. Copyright Â© 2024 Dave Kerr. Website built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5430b760.js"></script>
<script src="/assets/js/main.ca0d9daf.js"></script>
</body>
</html>