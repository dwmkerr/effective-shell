"use strict";(self.webpackChunkeffective_shell=self.webpackChunkeffective_shell||[]).push([[8817],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>c});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},h=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),d=p(n),u=i,c=d["".concat(s,".").concat(u)]||d[u]||m[u]||r;return n?a.createElement(c,o(o({ref:t},h),{},{components:n})):a.createElement(c,o({ref:t},h))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9323:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const r={title:"Thinking in Pipelines",slug:"/part-2-core-skills/thinking-in-pipelines/"},o=void 0,l={unversionedId:"core-skills/thinking-in-pipelines/index",id:"core-skills/thinking-in-pipelines/index",title:"Thinking in Pipelines",description:"Understanding the concept of pipelines in the shell, as well as how input and output work for command line programs is critical to be able to use the shell effectively.",source:"@site/docs/02-core-skills/07-thinking-in-pipelines/index.md",sourceDirName:"02-core-skills/07-thinking-in-pipelines",slug:"/part-2-core-skills/thinking-in-pipelines/",permalink:"/part-2-core-skills/thinking-in-pipelines/",draft:!1,editUrl:"https://github.com/dwmkerr/effective-shell/edit/main/docs/02-core-skills/07-thinking-in-pipelines/index.md",tags:[],version:"current",frontMatter:{title:"Thinking in Pipelines",slug:"/part-2-core-skills/thinking-in-pipelines/"},sidebar:"sidebar",previous:{title:"Part 2 - Core Skills",permalink:"/part-2-core-skill/"},next:{title:"Fly on the Command Line",permalink:"/part-2-core-skills/fly-on-the-command-line"}},s={},p=[{value:"Input and Output",id:"input-and-output",level:2},{value:"Standard Input, Output and Error",id:"standard-input-output-and-error",level:2},{value:"A Pipeline in Action",id:"a-pipeline-in-action",level:2},{value:"Common Patterns - Standard Input",id:"common-patterns---standard-input",level:2},{value:"Common Patterns - Standard Output",id:"common-patterns---standard-output",level:2},{value:"Common Patterns - Standard Error",id:"common-patterns---standard-error",level:2},{value:"One Last Trick - The T Pipe",id:"one-last-trick---the-t-pipe",level:2},{value:"Thinking in Pipelines",id:"thinking-in-pipelines",level:2},{value:"Summary",id:"summary",level:2}],h={toc:p};function d(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,a.Z)({},h,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Understanding the concept of ",(0,i.kt)("em",{parentName:"p"},"pipelines")," in the shell, as well as how input and output work for command line programs is critical to be able to use the shell effectively."),(0,i.kt)("p",null,"In this chapter, we'll look at the ways programs handle input and output, then we'll look at how we can chain multiple commands together with pipelines. We'll also look at some really common ways to use pipelines which should hopefully make your life easier!"),(0,i.kt)("p",null,"When you understand these concepts, it will open up a new world in terms of what you can do with in the shell. We'll briefly touch on the 'The Unix Philosophy', which is a concept which allows us to perform highly complex tasks by composing together small, simple components."),(0,i.kt)("h2",{id:"input-and-output"},"Input and Output"),(0,i.kt)("p",null,"Many of the programs we have seen so far follow a very similar pattern:"),(0,i.kt)("img",{src:n(7007).Z,alt:"Diagram: Input -> Program -> Output",width:"480px"}),(0,i.kt)("p",null,"In fact, when you get down to the details, there are very few programs which ",(0,i.kt)("em",{parentName:"p"},"don't")," do something like this! As a more concrete example, we can look at the ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," program - which sorts the input in alphabetic order:"),(0,i.kt)("img",{src:n(1023).Z,alt:"Diagram: Sort",width:"480px"}),(0,i.kt)("p",null,"We can easily see this in action by just running ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," in a shell. Start the ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," program, enter some text, then press ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl+D"),". ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl+D")," (which is normally written as ",(0,i.kt)("inlineCode",{parentName:"p"},"^D")," is a special ",(0,i.kt)("em",{parentName:"p"},"control character")," which means 'end of transmission' - in this case we use it to tell ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," we've finished writing text. If you were to use ",(0,i.kt)("inlineCode",{parentName:"p"},"^C")," (which is the ",(0,i.kt)("em",{parentName:"p"},"interrupt")," command) it would closes the ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," program instead)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sort\nDogs\nchase\ncats\nand\ncats\nchase\nmice\n")),(0,i.kt)("p",null,"Once you've entered the text you want to sort, hit ",(0,i.kt)("inlineCode",{parentName:"p"},"^D")," and you'll see the sorted output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Dogs\nand\ncats\ncats\nchase\nchase\nmice\n")),(0,i.kt)("p",null,"So by default, the ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," command is reading ",(0,i.kt)("em",{parentName:"p"},"input")," from the keyboard (until we send it a special message saying we're done), then writing the ",(0,i.kt)("em",{parentName:"p"},"output")," to the terminal."),(0,i.kt)("p",null,"In fact, ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," is using two special ",(0,i.kt)("em",{parentName:"p"},"files")," - ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," - but what does this mean?"),(0,i.kt)("h2",{id:"standard-input-output-and-error"},"Standard Input, Output and Error"),(0,i.kt)("p",null,"Every program has access to three 'special' files, ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr"),":"),(0,i.kt)("img",{src:n(6699).Z,alt:"Diagram: stdin, stdout, stderr",width:"480px"}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stdin")," is short for 'standard input' - it's where ",(0,i.kt)("em",{parentName:"li"},"many")," programs read their input from"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stdout")," is short for 'standard output' - it's where ",(0,i.kt)("em",{parentName:"li"},"many")," programs write their output to"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stderr")," is short for 'standard error' -  it's where ",(0,i.kt)("em",{parentName:"li"},"some")," programs write error messages to")),(0,i.kt)("p",null,"Why do I say 'many' and 'some'? Well the reason is that while this is ",(0,i.kt)("em",{parentName:"p"},"convention"),", it is not adhered to universally. Anyone who writes a program is free to choose how they read input and write output, so some programs might not follow these conventions. In Chapter 29 we'll look at how to write tools which follow these conventions, as well as others which are useful."),(0,i.kt)("p",null,"Each of these files has a special number which is shown in grey in the diagram. This is known as the ",(0,i.kt)("em",{parentName:"p"},"file descriptor")," and we'll see it later on. Each of these files also has a special location in the system which you can access directly - you can see these files by running ",(0,i.kt)("inlineCode",{parentName:"p"},"ls -al /dev/std*"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ls -al /dev/std*\nlr-xr-xr-x 1 root wheel 0 Jan  1  1970 /dev/stderr -> fd/2\nlr-xr-xr-x 1 root wheel 0 Jan  1  1970 /dev/stdin -> fd/0\nlr-xr-xr-x 1 root wheel 0 Jan  1  1970 /dev/stdout -> fd/1\n")),(0,i.kt)("p",null,"If you are not familiar with ",(0,i.kt)("inlineCode",{parentName:"p"},"ls")," (the ",(0,i.kt)("em",{parentName:"p"},"list directory contents")," command) then check ",(0,i.kt)("a",{parentName:"p",href:"/part-1-transitioning-to-the-shell/navigating-your-system/"},"Chapter 2 - Navigating Your System"),". The first part of the output isn't too important - but we can see we have three files in the special ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/")," (short for ",(0,i.kt)("em",{parentName:"p"},"device")," folder). We can also see the associated file descriptors."),(0,i.kt)("p",null,"As an aside - this is a really fundamental thing we'll see again and again in Unix and Linux - almost everything can be represented as a file. This is a core concept and one we'll touch on regularly."),(0,i.kt)("p",null,"When you are running programs in a shell, the shell attaches your keyboard to the program's standard input",(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1")),", and attaches the standard output and standard error to the terminal display:"),(0,i.kt)("img",{src:n(4956).Z,alt:"Diagram: Shell, Keyboard, Terminal",width:"640px"}),(0,i.kt)("p",null,"This means when we're in a shell, we can type on the keyboard, which goes to the input of the program and then as the program outputs information and errors they show up on the screen."),(0,i.kt)("p",null,"We can already see the beginnings of a ",(0,i.kt)("strong",{parentName:"p"},"pipeline")," here. There's a clear flow of data from the keyboard, through the ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," file, through the program, then through the output files, then to the display."),(0,i.kt)("p",null,"Looking at some real programs in action will hopefully make this clearer!"),(0,i.kt)("h2",{id:"a-pipeline-in-action"},"A Pipeline in Action"),(0,i.kt)("p",null,"Do you remember the ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," command? It's the one which writes the contents of a file to the screen. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat ~/effective-shell/text/simpsons-characters.txt\nArtie Ziff\nKirk Van Houten\nTimothy Lovejoy\nArtie Ziff\nNick Riviera\nSeymore Skinner\nHank Scorpio\nTimothy Lovejoy\nJohn Frink\nCletus Spuckler\nRuth Powers\nArtie Ziff\nAgnes Skinner\nHelen Lovejoy\n")),(0,i.kt)("p",null,"We saw in ",(0,i.kt)("a",{parentName:"p",href:"/part-1-transitioning-to-the-shell/become-a-clipboard-gymnast/"},"Chapter 4 - Becoming a Clipboard Gymnast")," that we could ",(0,i.kt)("strong",{parentName:"p"},"pipe")," the output of this command into the ",(0,i.kt)("inlineCode",{parentName:"p"},"sort")," command to order it and then into the ",(0,i.kt)("inlineCode",{parentName:"p"},"uniq")," command to remove duplicates, like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat ~/effective-shell/text/simpsons-characters.txt | sort | uniq\nAgnes Skinner\nArtie Ziff\nCletus Spuckler\nHank Scorpio\nHelen Lovejoy\nJohn Frink\nKirk Van Houten\nNick Riviera\nRuth Powers\nSeymore Skinner\nTimothy Lovejoy\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("strong",{parentName:"p"},"pipe")," operator (which is the vertical pipe symbol or ",(0,i.kt)("inlineCode",{parentName:"p"},"|"),") has a very specific meaning in the shell - it attaches the ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," of the first program to the ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," of the second. This means we can now visualise the entire pipeline and see exactly what is going on:"),(0,i.kt)("img",{src:n(586).Z,alt:"Diagram: cat-sort-uniq pipeline",width:"1024px"}),(0,i.kt)("p",null,"That's it! If you can follow what is going on here then you have the key information you need to know to understand how pipelines work. The pipe operator just connects the output of one program to the input of another. A pipeline is just a set of connected programs. Easy!"),(0,i.kt)("p",null,"We could do the same thing by writing the output of each step as a file, then reading that file with the next step, but that would mean we'd have a lot of intermediate files to clean up (and if we're processing a ",(0,i.kt)("em",{parentName:"p"},"big")," file, it also uses a lot of space). Pipelines let us create complex sequences of operations which work well even on very large files."),(0,i.kt)("p",null,"Now we'll look at ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," in a little more detail. We'll be seeing these special streams a lot as we go through the book. Knowing more about them is really going to help you when working in the shell or with Linux-like systems."),(0,i.kt)("h2",{id:"common-patterns---standard-input"},"Common Patterns - Standard Input"),(0,i.kt)("p",null,"Let's have a quick look at some of the common things we might see as sources of inputs for other programs. Each one illustrates an interesting point about how the shell or the standard input stream works."),(0,i.kt)("img",{src:n(3657).Z,alt:"Diagram: Input Examples",width:"1024px"}),(0,i.kt)("p",null,"This list is by no means exhaustive, in fact with a bit of tinkering you can make almost anything the input to anything else, but let's check each example."),(0,i.kt)("p",null,"These examples will use some new programs to transform the output - don't worry about the details of them, each will be described as we go through the book!"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"The Shell")),(0,i.kt)("p",null,"You might just use code in the shell as input, for example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ echo \"I am in the $PWD folder\" | sed 's/folder/directory/'\nI am in the /Users/dwmkerr/repos/github/dwmkerr/effective-shell directory\n")),(0,i.kt)("p",null,"Here we've just used ",(0,i.kt)("inlineCode",{parentName:"p"},"echo")," to write out message including a variable and then used the ",(0,i.kt)("inlineCode",{parentName:"p"},"sed")," (",(0,i.kt)("em",{parentName:"p"},"stream editor"),") program to replace the word ",(0,i.kt)("inlineCode",{parentName:"p"},"folder")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"directory"),". We'll get a lot of practice with ",(0,i.kt)("inlineCode",{parentName:"p"},"sed")," as we go through this book!"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Files")),(0,i.kt)("p",null,"We've already seen a few examples of using ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," to write a file to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),"."),(0,i.kt)("p",null,"A lot of the time we don't need to use ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," many programs accept the path of a file as a parameter, meaning we can just tell the program to open the file directly. For example, we could count the number of lines in a file like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat ~/effective-shell/text/simpsons-characters.txt | wc -l\n\n      14\n")),(0,i.kt)("p",null,"Or more simply, like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ wc -l ~/effective-shell/text/simpsons-characters.txt\n      14 /Users/dwmkerr/effective-shell/text/simpsons-characters.txt\n")),(0,i.kt)("p",null,"In this case, we've passed the file path as an argument to the ",(0,i.kt)("inlineCode",{parentName:"p"},"wc")," (",(0,i.kt)("em",{parentName:"p"},"word, line, character and byte count"),") program. But be aware - not all programs use the same convention or parameter names!"),(0,i.kt)("p",null,"Now here's a cool trick. Type ",(0,i.kt)("inlineCode",{parentName:"p"},"rev < /dev/stdin"),", then enter some text and hit ",(0,i.kt)("inlineCode",{parentName:"p"},"^D")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"^C")," when done. You should see something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ rev < /dev/stdin\nRed Rum\nmuR deR\n")),(0,i.kt)("p",null,"What's going on here?  Remember we mentioned that ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," is a special stream which represents input and that it lives at ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/stdin"),"? This little trick uses ",(0,i.kt)("em",{parentName:"p"},"redirection")," to redirect the ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," file to the ",(0,i.kt)("inlineCode",{parentName:"p"},"rev")," (",(0,i.kt)("em",{parentName:"p"},"reverse"),") command."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"<")," operator redirects the standard input of a program to come from the given file. We could also have written ",(0,i.kt)("inlineCode",{parentName:"p"},"cat /dev/stdin | rev"),". Or just enter ",(0,i.kt)("inlineCode",{parentName:"p"},"rev")," and type in the input we want to reverse!"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"The Clipboard")),(0,i.kt)("p",null,"In ",(0,i.kt)("a",{parentName:"p",href:"/part-1-transitioning-to-the-shell/become-a-clipboard-gymnast/"},"Chapter 4 - Becoming a Clipboard Gymnast")," we saw a trick to remove formatting from text in the clipboard. Here's a similar trick to reverse the contents of the clipboard:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ pbpaste | rev | pbcopy\n")),(0,i.kt)("p",null,"This pipeline pastes the contents of the clipboard to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),", which is piped to ",(0,i.kt)("inlineCode",{parentName:"p"},"rev")," (reversing the text) and then pipes the output to ",(0,i.kt)("inlineCode",{parentName:"p"},"pbcopy"),", which copies the results to the clipboard",(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2")),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Filtered Input")),(0,i.kt)("p",null,"This is a trick a friend shared with me. He works with data scientists and whenever he shows them this command they love it!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ head -n 100 100GBFile.csv > 100linefile.csv\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"head")," (",(0,i.kt)("em",{parentName:"p"},"display first lines of a file"),") command in this case just grabs the first 100 lines of a file and puts it straight into a smaller, more manageable file. We'll see what the ",(0,i.kt)("inlineCode",{parentName:"p"},">")," symbol (the ",(0,i.kt)("em",{parentName:"p"},"redirection")," symbol) means in the section lower down on Standard Output."),(0,i.kt)("p",null,"You can also use ",(0,i.kt)("inlineCode",{parentName:"p"},"tail")," in the same way to get the ",(0,i.kt)("em",{parentName:"p"},"last")," lines from a file. And if you are a more advanced user, you might use something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ grep -C 5 error /var/log/mylogfile.txt | less\n")),(0,i.kt)("p",null,"We'll see all of these commands as we go through the book, but this very cool trick uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"grep")," (",(0,i.kt)("em",{parentName:"p"},"file pattern searcher"),") command to search for the text ",(0,i.kt)("inlineCode",{parentName:"p"},"error")," in the file ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/log/mylogfile.txt"),", shows five lines of ",(0,i.kt)("em",{parentName:"p"},"context")," (",(0,i.kt)("inlineCode",{parentName:"p"},"-C 5"),"), which are the lines before and after the match, then puts the result into your pager! We'll see the pager just below. We'll do a lot of ",(0,i.kt)("inlineCode",{parentName:"p"},"grep"),"-ing as we go through the book so don't worry if this looks a little confusing for now."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Many More!")),(0,i.kt)("p",null,"We've only scratched the surface - almost any program will write to the standard output, meaning it can be the input for any pipeline you can imagine!"),(0,i.kt)("h2",{id:"common-patterns---standard-output"},"Common Patterns - Standard Output"),(0,i.kt)("p",null,"Now let's look at some of the things we can do with the standard output:"),(0,i.kt)("img",{src:n(4146).Z,alt:"Diagram: Output Examples",width:"1024px"}),(0,i.kt)("p",null,"Some of these outputs are things we've seen before, but let's do a quick revision."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Display")),(0,i.kt)("p",null,"This is what we've been doing a lot of so far.  When you are working with the shell ",(0,i.kt)("em",{parentName:"p"},"interactively")," this makes a lot of sense."),(0,i.kt)("p",null,"If you have jobs which run in the ",(0,i.kt)("em",{parentName:"p"},"background")," (or on a timer, such as backup jobs which run nightly), you might not actually have a terminal attached to the program to see the output, in which case you'll likely write to a file."),(0,i.kt)("p",null,"What about if you have a ",(0,i.kt)("em",{parentName:"p"},"lot")," of output? It can be quite inconvenient to have to scroll through the terminal (or impossible, depending on the system you are on). In this case use a ",(0,i.kt)("em",{parentName:"p"},"pager"),". A pager is a program which makes it possible to interactively ",(0,i.kt)("em",{parentName:"p"},"page")," through output in the shell, scrolling up and down, searching and so on."),(0,i.kt)("p",null,"Try this out as an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ls /usr/bin /usr/local/bin /usr/sbin | less\n")),(0,i.kt)("p",null,"You'll see something like this:"),(0,i.kt)("img",{src:n(1377).Z,alt:"Screenshot: Less Example",width:"800px"}),(0,i.kt)("p",null,"This long list of files would be hard to search through if it was printed directly to the shell, but in the pager we can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"d")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"u")," keys to go ",(0,i.kt)("em",{parentName:"p"},"down")," and ",(0,i.kt)("em",{parentName:"p"},"up"),", or the ",(0,i.kt)("inlineCode",{parentName:"p"},"/")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"?")," keys to search forwards or backwards."),(0,i.kt)("p",null,"Piping into your pager is a really useful trick - you can read more about pagers in ",(0,i.kt)("a",{parentName:"p",href:"/part-1-transitioning-to-the-shell/getting-help/"},"Chapter 5 - Getting Help"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"File")),(0,i.kt)("p",null,"The shell has a built in operator which will pipe the standard output of a program and write it to a file. It is the ",(0,i.kt)("inlineCode",{parentName:"p"},">")," or ",(0,i.kt)("em",{parentName:"p"},"redirection")," operator:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ echo "Here\'s some data" > some_file.txt\n')),(0,i.kt)("p",null,"It's as easy as that! Note that this will ",(0,i.kt)("em",{parentName:"p"},"overwrite")," anything already in the file."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Append")),(0,i.kt)("p",null,"What if you don't want to overwrite a file, but instead just add a new line? The ",(0,i.kt)("inlineCode",{parentName:"p"},">>")," or ",(0,i.kt)("em",{parentName:"p"},"append redirection")," operator:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ echo "Tuesday was good" >> diary.txt\n$ echo "Wednesday was better!" >> diary.txt\n$ echo "Thursday suuucks" >> diary.txt\n$ cat diary.txt\nTuesday was good\nWednesday was better!\nThursday suuucks\n')),(0,i.kt)("p",null,"This example writes each line in turn to the ",(0,i.kt)("inlineCode",{parentName:"p"},"diary.txt")," file, appending the text to the end of the file (and creating it if it doesn't already exist)."),(0,i.kt)("p",null,"Appending to a file is extremely useful for circumstances where you might want to build or update a log of events over time."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Pipe")),(0,i.kt)("p",null,"This is what we've spent most of this chapter looking at - to simply pipe the standard output to the standard input of another program!"),(0,i.kt)("p",null,"In this case, the output of our program becomes the input of the next one in the pipeline."),(0,i.kt)("h2",{id:"common-patterns---standard-error"},"Common Patterns - Standard Error"),(0,i.kt)("p",null,"We haven't actually seen ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," in action yet. Let's see how it works."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ mkdir ~/effective-shell/new-folder\n$ mkdir ~/effective-shell/new-folder\nmkdir: /home/dwmkerr/effective-shell/new-folder: File exists\n")),(0,i.kt)("p",null,"In the first call to ",(0,i.kt)("inlineCode",{parentName:"p"},"mkdir"),", the folder is created successfully. In the second call, we get an error. Now let's try and use this output and make it louder - making all of the text uppercase."),(0,i.kt)("p",null,"There are lots of ways to make text uppercase in the shell, let's use the ",(0,i.kt)("inlineCode",{parentName:"p"},"tr")," (",(0,i.kt)("em",{parentName:"p"},"translate characters"),") program. Here's an example of how it works:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ echo 'Be quiet, this is a library!' | tr '[:lower:]' '[:upper:]'\nBE QUIET, THIS IS A LIBRARY!\n")),(0,i.kt)("p",null,"Now let's use it to shout out our error message:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ mkdir ~/effective-shell/new-folder | tr '[:lower:]' '[:upper:]'\nmkdir: /home/dwmkerr/effective-shell/new-folder: File exists\n")),(0,i.kt)("p",null,"In this case the output has not been made uppercase. What's going on?"),(0,i.kt)("p",null,"To understand, let's quickly review the three streams:"),(0,i.kt)("img",{src:n(6699).Z,alt:"Diagram: stdin/stdout/stderr",width:"1024px"}),(0,i.kt)("p",null,"When we are in the shell, the shell automatically writes the ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," stream to the screen. But the shell's ",(0,i.kt)("em",{parentName:"p"},"pipe")," operator pipes ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," only - it is ",(0,i.kt)("em",{parentName:"p"},"not")," piping our error output. And the ",(0,i.kt)("inlineCode",{parentName:"p"},"mkdir")," command is writing this error message to ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr"),"."),(0,i.kt)("p",null,"The command we ran before:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mkdir ~/effective-shell/new-folder | tr '[:lower:]' '[:upper:]'\n")),(0,i.kt)("p",null,"Actually looks like this:"),(0,i.kt)("img",{src:n(930).Z,alt:"Diagram: Standard Error",width:"1024px"}),(0,i.kt)("p",null,"The pipe ",(0,i.kt)("em",{parentName:"p"},"has")," piped the standard output to the ",(0,i.kt)("inlineCode",{parentName:"p"},"tr")," program. But there is no standard output - the error message was written to ",(0,i.kt)("em",{parentName:"p"},"standard error")," instead. The shell has still written it to the screen for us, but has not piped it to the ",(0,i.kt)("inlineCode",{parentName:"p"},"tr")," program."),(0,i.kt)("p",null,"So how do we deal with ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr"),"? Here are some common options:"),(0,i.kt)("img",{src:n(3523).Z,alt:"Diagram: Standard Error Options",width:"1024px"}),(0,i.kt)("p",null,"Now this might be the ",(0,i.kt)("strong",{parentName:"p"},"ah-ha!")," moment if you have done some shell scripting before - some of these obscure sequences like ",(0,i.kt)("inlineCode",{parentName:"p"},"2>&1")," might look familiar (even if it is just the thing you know you always have to Google to get right!)."),(0,i.kt)("p",null,"Let's take a quick look at some of these options."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"To Standard Output")),(0,i.kt)("p",null,"If we want to be able to pipe the error message to another command, we can use another redirection trick - we can redirect ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),"."),(0,i.kt)("p",null,"The characters ",(0,i.kt)("inlineCode",{parentName:"p"},"2>&1")," look really obscure - let's break it down:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Take the file with descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"2")," - which is ",(0,i.kt)("em",{parentName:"li"},"standard error")),(0,i.kt)("li",{parentName:"ul"},"Redirect it with the redirect symbol ",(0,i.kt)("inlineCode",{parentName:"li"},">")," - we saw this in the earlier section"),(0,i.kt)("li",{parentName:"ul"},"Redirect it into the file with descriptor (",(0,i.kt)("inlineCode",{parentName:"li"},"&"),") ",(0,i.kt)("inlineCode",{parentName:"li"},"1")," - which is ",(0,i.kt)("em",{parentName:"li"},"standard output"))),(0,i.kt)("p",null,"Remember, there are three 'magic' files each process has access to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stdin"),", the standard input, which has the file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stdout"),", the standard output, which has the file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"1")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stderr"),", the standard error, which has the file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"2"))),(0,i.kt)("p",null,"File descriptors are just numbers the operating system uses to keep track of files. When a program opens a 'normal' file, it'll get a new file descriptor. Here's a little example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"python <<EOF\nimport os\nfor r in range(3): print(os.open('/dev/random', os.O_RDONLY))\nEOF\n")),(0,i.kt)("p",null,"This code uses redirection (see how useful it is?) to pipe a small Python script into the Python program, which writes the results to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),". You will probably see the following output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"3\n4\n5\n")),(0,i.kt)("p",null,"It doesn't really matter whether you know Python or not (and there weird looking ",(0,i.kt)("inlineCode",{parentName:"p"},"EOF")," is a ",(0,i.kt)("em",{parentName:"p"},"heredoc")," which we have a whole chapter on later). The script is just a way of showing the file descriptors that the operating system gives me when I try to open three files (each time I open the same file, the magic ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/random")," file which just contains random data)."),(0,i.kt)("p",null,"The interesting thing is that the descriptors in my program start from ",(0,i.kt)("inlineCode",{parentName:"p"},"3")," and go upwards - that's because ",(0,i.kt)("inlineCode",{parentName:"p"},"0"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," are already in use, for ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr"),"!"),(0,i.kt)("p",null,"So to make our error message go through the ",(0,i.kt)("inlineCode",{parentName:"p"},"tr")," command, we can redirect ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),", which means the error message will go to ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," and then be piped to ",(0,i.kt)("inlineCode",{parentName:"p"},"tr"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ mkdir ~/effective-shell/new-folder 2>&1 | tr '[:lower:]' '[:upper:]'\nMKDIR: /HOME/DWMKERR/PLAYGROUND/NEW-FOLDER: FILE EXISTS\n")),(0,i.kt)("p",null,"Visually, what is happening is this:"),(0,i.kt)("img",{src:n(9387).Z,alt:"Diagram: stderr redirect",width:"1024px"}),(0,i.kt)("p",null,"If you can wrap your head around this, the other options we showed for ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," might start to make a little more sense."),(0,i.kt)("p",null,"A nice trick to remember the slightly obscure ampersand ",(0,i.kt)("inlineCode",{parentName:"p"},"&")," which references a file descriptor - if you were to write this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cat some-file-that-might-not-exist 2>1\n")),(0,i.kt)("p",null,"What would happen is that the shell would write ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," to a ",(0,i.kt)("em",{parentName:"p"},"new file")," with the name ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"! Why don't we need an ampersand ",(0,i.kt)("em",{parentName:"p"},"before")," the ",(0,i.kt)("inlineCode",{parentName:"p"},">")," symbol, only for the file descriptor afterwards? This is just because the shell only supports redirecting file descriptors, so an additional ampersand would be superfluous."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"To a File")),(0,i.kt)("p",null,"Before, we redirected to ",(0,i.kt)("inlineCode",{parentName:"p"},"&2"),", which is 'the file with descriptor ",(0,i.kt)("inlineCode",{parentName:"p"},"2"),". We can also use a similar trick to redirect to any arbitrary file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir ~/effective-shell/new-folder 2>./errors.txt\n")),(0,i.kt)("p",null,"This command just redirects all of the errors (remember, ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr"),") to a file called ",(0,i.kt)("inlineCode",{parentName:"p"},"./errors.txt"),"."),(0,i.kt)("p",null,"This is quite a common trick - run the program, but log the errors to a file for later review."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"To Nowhere")),(0,i.kt)("p",null,"What if we just don't want to see the errors at all? Well there's a special file called ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/null")," which we can use for this. When we write to this file, the operating system just discards the input. In fact, it exists for just this kind of purpose!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mkdir ~/effective-shell/new-folder 2>/dev/null\n")),(0,i.kt)("p",null,"This just redirects all errors to the black hole of ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/null")," - we won't see them on the screen or anywhere else. This is a common way to 'silence' errors",(0,i.kt)("sup",{parentName:"p",id:"fnref-3"},(0,i.kt)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))," in shell commands."),(0,i.kt)("p",null,"Notice how we're starting to see patterns? This is just redirection, the same tricks we saw for ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),", but we're explicitly redirecting ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," (file descriptor ",(0,i.kt)("inlineCode",{parentName:"p"},"2"),"). If we don't tell the shell ",(0,i.kt)("em",{parentName:"p"},"what")," to redirect, it assumes ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," by default."),(0,i.kt)("p",null,"So if we can redirect, can we append too?"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Append")),(0,i.kt)("p",null,"Yes! Just like we did with ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout"),", there's nothing stopping us ",(0,i.kt)("em",{parentName:"p"},"appending")," to a file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mkdir ~/effective-shell/new-folder 2>>./all-errors.log\n")),(0,i.kt)("p",null,"Just like before, we use ",(0,i.kt)("inlineCode",{parentName:"p"},">>")," which means ",(0,i.kt)("em",{parentName:"p"},"append")," (rather than ",(0,i.kt)("em",{parentName:"p"},"overwrite or create"),")."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"All to a File")),(0,i.kt)("p",null,"This is a really important subtlety. If you want to write ",(0,i.kt)("em",{parentName:"p"},"both")," ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stderr")," to a file, you might try this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ls /usr/bin /nothing 2>&1 > all-output.txt\n")),(0,i.kt)("p",null,"If you run this command, you'll get ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," written to ",(0,i.kt)("inlineCode",{parentName:"p"},"all-output.txt"),", but the error message ",(0,i.kt)("inlineCode",{parentName:"p"},"cannot access  '/nothing'")," is written to the screen, not the file. Why is this?"),(0,i.kt)("p",null,"Bash (and most bash-like shells) process redirections from ",(0,i.kt)("em",{parentName:"p"},"left to right"),", and when we redirect we ",(0,i.kt)("em",{parentName:"p"},"duplicate")," the source. So breaking this down:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"2>&1")," - duplicate file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"2")," (",(0,i.kt)("inlineCode",{parentName:"li"},"stderr"),") and write it to ",(0,i.kt)("inlineCode",{parentName:"li"},"1")," - which is ",(0,i.kt)("em",{parentName:"li"},"currently the terminal"),"!"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"> all-output.txt")," - duplicate file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"1")," (",(0,i.kt)("inlineCode",{parentName:"li"},"stdout"),") and write it to a file called ",(0,i.kt)("inlineCode",{parentName:"li"},"all-output.txt"))),(0,i.kt)("p",null,"To write ",(0,i.kt)("em",{parentName:"p"},"everything")," to the file, try do this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ls /usr/bin /nothing > all-output.txt 2>&1\n")),(0,i.kt)("p",null,"This will work. Breaking it down:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Redirect ",(0,i.kt)("inlineCode",{parentName:"li"},"stdout")," to the file ",(0,i.kt)("inlineCode",{parentName:"li"},"all-output.txt")),(0,i.kt)("li",{parentName:"ul"},"Now redirect ",(0,i.kt)("inlineCode",{parentName:"li"},"stderr")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"stdout")," - which by this point ",(0,i.kt)("em",{parentName:"li"},"has already been redirected to a file"))),(0,i.kt)("p",null,"This can be tough to remember so it's worth trying it out",(0,i.kt)("sup",{parentName:"p",id:"fnref-4"},(0,i.kt)("a",{parentName:"sup",href:"#fn-4",className:"footnote-ref"},"4")),". There are many variations you can play with and we'll see more as we go through the book."),(0,i.kt)("h2",{id:"one-last-trick---the-t-pipe"},"One Last Trick - The T Pipe"),(0,i.kt)("p",null,"This is a long chapter, but I can't talk about pipelines without briefly mentioning the T pipe. Check out this command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cat ~/effective-shell/text/simpsons-characters.txt | sort | tee sorted.txt | uniq | grep '^A'\n")),(0,i.kt)("p",null,"This command sorts the list of Simpsons characters, removes duplicates and filters down to ones which start with the letter ",(0,i.kt)("inlineCode",{parentName:"p"},"A"),". And it has the ",(0,i.kt)("inlineCode",{parentName:"p"},"tee")," command in the middle. What does this do?"),(0,i.kt)("p",null,"Well the ",(0,i.kt)("inlineCode",{parentName:"p"},"tee")," command is like a T-pipe in plumbing - it lets the stream of data go in two directions! The ",(0,i.kt)("inlineCode",{parentName:"p"},"sorted.txt")," file contains the sets of characters ",(0,i.kt)("em",{parentName:"p"},"after")," the sort operation, but before the unique and filter operation. Visually, it does this:"),(0,i.kt)("img",{src:n(1658).Z,alt:"Diagram: Tee",width:"1024px"}),(0,i.kt)("p",null,"As soon as you visualise a T-pipe it's easy to remember this useful command! You might use it in more complex pipelines or other scenarios to write things to a file which would otherwise go straight to another program or just the display."),(0,i.kt)("h2",{id:"thinking-in-pipelines"},"Thinking in Pipelines"),(0,i.kt)("p",null,"Once you get comfortable with pipelines, a whole world of possibilities open up."),(0,i.kt)("p",null,"Just the day before I wrote this chapter, I had to find out how many unique data points were in a data file, which also included empty lines and comments, it took less than a minute to quickly build this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cat data.dat | sort | uniq | grep -v '^#' | wc -l\n")),(0,i.kt)("p",null,"I didn't have to find a special program which does exactly what I needed",(0,i.kt)("sup",{parentName:"p",id:"fnref-5"},(0,i.kt)("a",{parentName:"sup",href:"#fn-5",className:"footnote-ref"},"5"))," - I just incrementally built a pipeline. Each section I added one by one, writing to the screen each time, until I had it working. The thought process was:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cat data.dat")," - OK, first I need to write out the file"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sort")," - now I can sort it, that'll put all the blank lines together"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"uniq")," - this'll remove all of those ",(0,i.kt)("em",{parentName:"li"},"duplicate")," blank lines, although it still leaves one blank one at the top!"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"grep -v '^#'")," - this should get rid of all the lines which start with ",(0,i.kt)("inlineCode",{parentName:"li"},"#")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"wc -l")," - this'll count the number of lines I'm left with")),(0,i.kt)("p",null,"Now there's probably better ways, and this has an oddity which is that if there are blank lines it'll remove all but one of them (although that would be quick to fix), but it gave me my quick and dirty answer in less than a minute."),(0,i.kt)("p",null,"Of course, as things get more complex you might want to build scripts, or use a programming language, or other methods, but this ",(0,i.kt)("em",{parentName:"p"},"Unix Philosophy")," (which we'll talk about more as we continue) of having lots of small, simple programs which we can chain together can be immensely powerful."),(0,i.kt)("h2",{id:"summary"},"Summary"),(0,i.kt)("p",null,"We'll see pipelines again and again. The standard streams, redirection, pipelines and all of the tricks we've introduced in this chapter are fundamental not only to using the shell effectively, but really understanding how computer programs work."),(0,i.kt)("p",null,"Don't be worried if this feels like a lot to take in - we'll see more and more examples in later chapters which will help reinforce these concepts. If you find yourself struggling later you might want to quickly review this chapter, because we introduced a lot!"),(0,i.kt)("p",null,"In this chapter we looked at:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"How each program has access to three 'standard' streams - one for input, one for output and one for reporting errors"),(0,i.kt)("li",{parentName:"ul"},"The standard input stream is available as a file at ",(0,i.kt)("inlineCode",{parentName:"li"},"/dev/stdin"),", is often called ",(0,i.kt)("inlineCode",{parentName:"li"},"stdin")," in programming languages, and always has the special file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"0")),(0,i.kt)("li",{parentName:"ul"},"The standard output stream is available as a file at ",(0,i.kt)("inlineCode",{parentName:"li"},"/dev/stdout"),", is often called ",(0,i.kt)("inlineCode",{parentName:"li"},"stdout")," in programming languages, and always has the special file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"1")),(0,i.kt)("li",{parentName:"ul"},"The standard error stream is available as a file at ",(0,i.kt)("inlineCode",{parentName:"li"},"/dev/stderr"),", is often called ",(0,i.kt)("inlineCode",{parentName:"li"},"stderr")," in programming languages, and always has the special file descriptor ",(0,i.kt)("inlineCode",{parentName:"li"},"2")),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"Ctrl+D")," sequence means 'end of transmission' - we can use it to signal that we have completed putting our input into ",(0,i.kt)("inlineCode",{parentName:"li"},"stdin"),"..."),(0,i.kt)("li",{parentName:"ul"},"...but the ",(0,i.kt)("inlineCode",{parentName:"li"},"Ctrl+C")," sequence means 'interrupt' and is normally used to force a program to close"),(0,i.kt)("li",{parentName:"ul"},"We can ",(0,i.kt)("em",{parentName:"li"},"pipe")," the output of one program to the input of another with the pipe ",(0,i.kt)("inlineCode",{parentName:"li"},"|")," symbol"),(0,i.kt)("li",{parentName:"ul"},"We can ",(0,i.kt)("em",{parentName:"li"},"redirect")," a file to the standard input of a program with the ",(0,i.kt)("inlineCode",{parentName:"li"},"<")," operator"),(0,i.kt)("li",{parentName:"ul"},"We can ",(0,i.kt)("em",{parentName:"li"},"redirect")," the standard output of a program to create or overwrite a file with the ",(0,i.kt)("inlineCode",{parentName:"li"},">")," operator"),(0,i.kt)("li",{parentName:"ul"},"We can ",(0,i.kt)("em",{parentName:"li"},"redirect")," the standard output of a program to create or append to a file with the ",(0,i.kt)("inlineCode",{parentName:"li"},">>")," operator"),(0,i.kt)("li",{parentName:"ul"},"We can redirect the standard error of a program to its standard output with ",(0,i.kt)("inlineCode",{parentName:"li"},"2>&1")),(0,i.kt)("li",{parentName:"ul"},"We can redirect the standard error of a program to another file (such as the 'null' file) with ",(0,i.kt)("inlineCode",{parentName:"li"},"2>/dev/null")),(0,i.kt)("li",{parentName:"ul"},"We can redirect the standard error of a program to create or append to a file, just like with standard output, using the ",(0,i.kt)("inlineCode",{parentName:"li"},">>")," operator")),(0,i.kt)("p",null,"We also briefly saw some commands:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sort")," sorts text"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sed")," can replace content in text"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"tr")," can replace parts of text"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"wc")," can count words or lines of text"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"tee")," takes the input stream and sends it straight to the output, but also to a file (like a T-pipe in plumbing)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"grep")," can filter lines")),(0,i.kt)("p",null,"These programs can do a lot more and are workhorses we'll see in more detail through the book."),(0,i.kt)("p",null,"There are a few chapters which are planned to come later which go into detail on some of the concepts we only briefly touched on:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Writing Good Programs - How to write programs which use ",(0,i.kt)("inlineCode",{parentName:"li"},"stdin"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"stdout")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"stderr")," sensibly"),(0,i.kt)("li",{parentName:"ul"},"The Unix Philosophy - Why we have so many small simple programs which we can pipe together"),(0,i.kt)("li",{parentName:"ul"},"Streams in Detail - How streams like ",(0,i.kt)("inlineCode",{parentName:"li"},"stdin")," actually work, especially with things like line endings, command sequences like ",(0,i.kt)("inlineCode",{parentName:"li"},"^D")," and so on"),(0,i.kt)("li",{parentName:"ul"},"Signals - A little more on Signals (such as ",(0,i.kt)("inlineCode",{parentName:"li"},"^C")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"^D"),")")),(0,i.kt)("p",null,"When these chapters are published I'll update the links here. If you want to be updated when new chapters are published, you can ",(0,i.kt)("a",{parentName:"p",href:"https://effective-shell.com"},"Join the Mailing Lits on the Homepage"),"."),(0,i.kt)("div",{className:"footnotes"},(0,i.kt)("hr",{parentName:"div"}),(0,i.kt)("ol",{parentName:"div"},(0,i.kt)("li",{parentName:"ol",id:"fn-1"},"Technically there is another layer here, which is the ",(0,i.kt)("inlineCode",{parentName:"li"},"tty"),". You can see this by running ",(0,i.kt)("inlineCode",{parentName:"li"},"tty")," in the shell. We'll talk more about this in the ",(0,i.kt)("a",{parentName:"li",href:"/part-2-core-skills/what-is-a-shell"},"Interlude - What is a Shell")," section.",(0,i.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-2"},"Check ",(0,i.kt)("a",{parentName:"li",href:"/part-1-transitioning-to-the-shell/become-a-clipboard-gymnast/"},"Chapter 4 - Becoming a Clipboard Gymnast")," for how to do this on a Linux or Windows machine.",(0,i.kt)("a",{parentName:"li",href:"#fnref-2",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-3"},"Although always use tricks like this with caution! If we had a ",(0,i.kt)("em",{parentName:"li"},"different")," error, perhaps one we really do want to know about, we would lose the message in this case.",(0,i.kt)("a",{parentName:"li",href:"#fnref-3",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-4"},"There is a very detailed explanation of this behaviour at ",(0,i.kt)("a",{parentName:"li",href:"https://linuxnewbieguide.org/21-and-understanding-other-shell-scripts-idioms/"},"https://linuxnewbieguide.org/21-and-understanding-other-shell-scripts-idioms/"),".",(0,i.kt)("a",{parentName:"li",href:"#fnref-4",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-5"},"With the correct options, ",(0,i.kt)("inlineCode",{parentName:"li"},"sed")," could likely do this in a single operation, but I'd probably spend a lot longer Googling the right options for it!",(0,i.kt)("a",{parentName:"li",href:"#fnref-5",className:"footnote-backref"},"\u21a9")))))}d.isMDXComponent=!0},586:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-cat-sort-uniq-pipeline-8c8d76566f351b4b9b900dde52af86b3.png"},3657:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-input-examples-e014dd4998bee0b50a94849ad55b01ce.png"},7007:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-input-program-output-fb71da951178e72bf4504bd292743d1c.png"},4146:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-output-examples-27e30c4a4036b2591e10e8c4fca7dc73.png"},4956:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-shell-keyboard-terminal-0475940cdf40bbcc8a329c090aa9e76a.png"},1023:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-sort-040db6e92c70e60612c9f711e81c9612.png"},3523:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-stderr-options-a2cde4aa6177249c25dd9e5c0c62667a.png"},9387:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-stderr-redirect-c7d8fe2d93a8cdb248924cc13027b59e.png"},930:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-stderr-d0845508087975a7d58ebac63e3a8cd5.png"},6699:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-stdin-stdout-stderr-702e578630d8d39c813d7d88c270c339.png"},1658:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/diagram-tee-6ad6dadcfa804f75f96b36807ffd688b.png"},1377:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/screenshot-less-65730c042d9a734b6f50168219fb70f7.png"}}]);