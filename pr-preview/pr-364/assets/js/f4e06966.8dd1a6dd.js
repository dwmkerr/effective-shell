"use strict";(self.webpackChunkeffective_shell=self.webpackChunkeffective_shell||[]).push([[4649],{1789:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),o=n(1262),i=n(412);const l=e=>{let{src:t,style:l,...r}=e;return a.createElement(o.default,null,(()=>{if(!i.Z.canUseDOM)return a.createElement("div",null,"ASCII Cinema Player Unavailable");const e=n(4828),o=(0,a.useRef)(null);return(0,a.useEffect)((()=>{const n=o.current;e.create(t,n,r)}),[t]),a.createElement("div",{ref:o,style:l})}))}},4167:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var a=n(7462),o=(n(7294),n(3905)),i=n(1789);const l={title:"Master the Multiplexer",slug:"/part-6-advanced-techniques/master-the-multiplexer/",chapterNumber:33},r=void 0,s={unversionedId:"advanced-techniques/master-the-multiplexer/index",id:"advanced-techniques/master-the-multiplexer/index",title:"Master the Multiplexer",description:"If you are regularly using a shell, then learning how to use a terminal multiplexer like screen or tmux can greatly improve your productivity. In this chapter we'll see how what a terminal multiplexer is, what it is used for, learn how to perform some common tasks and configure a multiplexer to make it even more useful.",source:"@site/docs/06-advanced-techniques/33-master-the-multiplexer/index.md",sourceDirName:"06-advanced-techniques/33-master-the-multiplexer",slug:"/part-6-advanced-techniques/master-the-multiplexer/",permalink:"/part-6-advanced-techniques/master-the-multiplexer/",draft:!1,editUrl:"https://github.com/dwmkerr/effective-shell/edit/main/docs/06-advanced-techniques/33-master-the-multiplexer/index.md",tags:[],version:"current",frontMatter:{title:"Master the Multiplexer",slug:"/part-6-advanced-techniques/master-the-multiplexer/",chapterNumber:33},sidebar:"sidebar",previous:{title:"A Vim Crash Course",permalink:"/part-6-advanced-techniques/a-vim-crash-course/"},next:{title:"Installing the Samples",permalink:"/xx-appendices/installing-samples/"}},m={},u=[{value:"What is a Terminal Multiplexer?",id:"what-is-a-terminal-multiplexer",level:2},{value:"Why use a Multiplexer?",id:"why-use-a-multiplexer",level:2},{value:"Introducing Screen and Tmux",id:"introducing-screen-and-tmux",level:2},{value:"Installing Tmux",id:"installing-tmux",level:2},{value:"Tmux Techniques",id:"tmux-techniques",level:2},{value:"The Leader",id:"the-leader",level:3},{value:"Window Management",id:"window-management",level:3},{value:"Creating Splits and Moving Between Splits",id:"creating-splits-and-moving-between-splits",level:4},{value:"Zooming Panes",id:"zooming-panes",level:4},{value:"Creating Windows and Moving Between Windows",id:"creating-windows-and-moving-between-windows",level:4},{value:"Quickly Navigating Between Windows",id:"quickly-navigating-between-windows",level:4},{value:"Quick Reference",id:"quick-reference",level:4},{value:"Session Management",id:"session-management",level:3},{value:"Attaching and Detaching from Sessions",id:"attaching-and-detaching-from-sessions",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:3},{value:"Collaboration",id:"collaboration",level:2},{value:"Going Further with Tmux",id:"going-further-with-tmux",level:2},{value:"Getting Help",id:"getting-help",level:2},{value:"Going Further with Tmux",id:"going-further-with-tmux-1",level:2},{value:"Summary",id:"summary",level:2}],d={toc:u};function p(e){let{components:t,...l}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"If you are regularly using a shell, then learning how to use a terminal multiplexer like ",(0,o.kt)("inlineCode",{parentName:"p"},"screen")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux")," can greatly improve your productivity. In this chapter we'll see how what a terminal multiplexer is, what it is used for, learn how to perform some common tasks and configure a multiplexer to make it even more useful."),(0,o.kt)("h2",{id:"what-is-a-terminal-multiplexer"},"What is a Terminal Multiplexer?"),(0,o.kt)("p",null,"A terminal multiplexer is a program that that allows a user, or many users, to run many programs at once. The multiplexer manages 'sessions' - these sessions run the programs, independently of your shell or terminal. Users can switch between sessions, save them, resume them, or even invite others to join the same session to allow collaboration. Multiplexers also normally offer 'window management' capabilities, allowing you to break your terminal into separate panes, tabs or windows."),(0,o.kt)("p",null,"The visual below shows a multiplexer in action - the one I am using while I write this chapter:"),(0,o.kt)("img",{alt:"Screenshot: A Terminal Multiplexer",src:n(8113).Z,width:"800px"}),(0,o.kt)("p",null,"In this image I am running the ",(0,o.kt)("em",{parentName:"p"},"Tmux")," multiplexer in my terminal. I have split the window into three panes - a large one on the left that contains the text for the chapter, and two smaller ones on the right. The upper right pane builds the effective shell website locally while I write, to check for errors, and the lower right contains a script I was working on."),(0,o.kt)("p",null,"When I want to switch between the tasks I'm working on, I don't need to start or stop any of the program, I can just switch between the 'panes' in my multiplexer."),(0,o.kt)("p",null,"At the bottom of the screen there are also two tabs - one that contains the website and the windows I'm currently working in, and another that has some windows for the manuscript for the book."),(0,o.kt)("p",null,"If I close my shell, the Tmux server is still running the sessions and I can re-open my terminal and resume. If I was to close my computer, when I restart my multiplexer will restart these programs for me, allowing me to pick up where I left off."),(0,o.kt)("h2",{id:"why-use-a-multiplexer"},"Why use a Multiplexer?"),(0,o.kt)("p",null,"It is not essential to know how to use a multiplexer. But knowing how to use one can certainly help you become a more effective shell user. Some of the key benefits to using a multiplexer are:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Window Management")),(0,o.kt)("p",null,"Much like modern 'tabbed interfaces', multiplexers can support multiple windows, tabs and panes within a window. This means you can arrange your workspace exactly how you want it. You can save the configuration of your windows and use it later. You can organise different windows into different sessions, allowing you to have many projects running at once, that you can quickly switch between, each one with a layout configured to suit your needs."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Persistence of Sessions")),(0,o.kt)("p",null,"Your programs are run independently from your terminal. If your terminal crashes, or freezes, your programs still run. If you are working with a remote machine, then you can run a multiplexer on it to manage your programs. This means that if your connection to the machine is reset, the programs will not stop running. You can re-attach to the session at later point and pick up where you left off. Session management is incredibly useful - you'll wonder how you lived without it if you use the shell a lot."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Configuration")),(0,o.kt)("p",null,"Multiplexers offer many configuration options to allow you to customise how programs are run and interfaced with, allowing you to set up the ideal environment for you to be effective."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Collaboration")),(0,o.kt)("p",null,"A multiplexer is a 'client-server' program. This means you as a user are a client and connect to a server that runs the multiplexer. But other users can connect as well - this means you can easily collaborate with other users, sharing your own work, connecting to theirs, or both working on a shared remote machine."),(0,o.kt)("p",null,"We'll look at a few of the most immediately useful features of multiplexers in this chapter - this will only really be scratching the surface but should be enough to help you decide whether it is a topic you'll investigate further on your own and add to your toolkit."),(0,o.kt)("h2",{id:"introducing-screen-and-tmux"},"Introducing Screen and Tmux"),(0,o.kt)("p",null,"The two most popular multiplexers are probably ",(0,o.kt)("em",{parentName:"p"},"GNU screen")," and ",(0,o.kt)("em",{parentName:"p"},"Tmux"),". GNU screen was created in the late 80s and has been used widely ever since. It is pre-installed on many Linux systems."),(0,o.kt)("p",null,"Tmux is a more modern multiplexer, created in 2007. It has most of the features of GNU screen, is also open source, and adds some very useful features to make it a little more user friendly."),(0,o.kt)("p",null,"For the rest of this chapter we are going to look at Tmux in detail. I've chosen Tmux rather than screen because I think its user-friendliness makes it a little better for people who are new to multiplexers. Once you are familiar with Tmux you might decide to switch to GNU screen - if so it will seem very familiar."),(0,o.kt)("h2",{id:"installing-tmux"},"Installing Tmux"),(0,o.kt)("p",null,"Tmux may already be installed on your system. You can check by trying the ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux -V")," command, which shows the current version:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tmux -V\ntmux 3.2a\n")),(0,o.kt)("p",null,"If it is not installed, or you do not have version 3 or higher, you should install the latest version of Tmux.  Install Tmux with the package manager for your system. The package name on most distributions is just ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux"),". As an example, on a Debian-based distribution we would install Tmux with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"apt install -y tmux\n")),(0,o.kt)("h2",{id:"tmux-techniques"},"Tmux Techniques"),(0,o.kt)("p",null,"Now that Tmux is installed let's see what we can do with it."),(0,o.kt)("h3",{id:"the-leader"},"The Leader"),(0,o.kt)("p",null,"One thing you'll notice when reading about Tmux and GNU screen is the ",(0,o.kt)("em",{parentName:"p"},"Leader"),". The leader is a key combination that prefixes any commands for the multiplexer. We just this leader combination so that the multiplexer key bindings don't clash with any existing ones. Typically you will use the leader keys to tell the multiplexer you are about to enter a command, then strike the keys that correspond to the command."),(0,o.kt)("p",null,"For Tmux, the default leader is ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl + B"),". For GNU screen it is ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl + A"),". You can easily remember these by remembering that Tmux is a successor to GNU screen, so the leader key letter is one letter further in the alphabet!"),(0,o.kt)("h3",{id:"window-management"},"Window Management"),(0,o.kt)("p",null,"Run the ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux")," program by entering the command below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"tmux\n")),(0,o.kt)("p",null,"We are now going to create some 'splits' - these will split our current window into separate panes. Each pane can run its own program. Let's take a look at a few commands for managing splits and panes."),(0,o.kt)("h4",{id:"creating-splits-and-moving-between-splits"},"Creating Splits and Moving Between Splits"),(0,o.kt)("p",null,"We can create a ",(0,o.kt)("em",{parentName:"p"},"vertical split")," by pressing ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+B")," followed by the ",(0,o.kt)("inlineCode",{parentName:"p"},"%")," percent symbol. We can create a ",(0,o.kt)("em",{parentName:"p"},"horizontal split")," by pressing ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+B")," followed by the ",(0,o.kt)("inlineCode",{parentName:"p"},'"')," quotes symbol. Finally, to move between splits, press ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+B")," followed by an arrow key."),(0,o.kt)("p",null,"The short video demonstrates both types of split and moving between panes:"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/483782.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("h4",{id:"zooming-panes"},"Zooming Panes"),(0,o.kt)("p",null,"You can 'zoom' a pane so that it takes up the entire window by moving to the pane you want to zoom and pressing ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+b z"),". To 'unzoom' a pane, you can just move to another pane (even if it is hidden) or simply press ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+B z")," again."),(0,o.kt)("p",null,"This what it looks like when we zoom a pane:"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484152.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("h4",{id:"creating-windows-and-moving-between-windows"},"Creating Windows and Moving Between Windows"),(0,o.kt)("p",null,"If you want to run a program in an entirely new window, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+b c")," command to create a window. To switch windows, press ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+b w")," to choose from the list of available windows:"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484161.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("h4",{id:"quickly-navigating-between-windows"},"Quickly Navigating Between Windows"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"^B w")," command shows all of the windows (and sessions!) for Tmux and let's you rapidly switch between them, this is extremely useful if you have a lot of windows!"),(0,o.kt)("p",null,"Here's how it looks in action - in this demo I have a few windows - notice that I've given them more clear names with ",(0,o.kt)("inlineCode",{parentName:"p"},"^B ,"),", this also makes it easier to sort and manage your windows."),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484350.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("h4",{id:"quick-reference"},"Quick Reference"),(0,o.kt)("p",null,"There are some other useful commands when working with windows:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Command"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b n")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the next window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b p")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the previous window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b 0")),(0,o.kt)("td",{parentName:"tr",align:null},"Select the window numbered '0' - use the number of any window from the status pane")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b &")),(0,o.kt)("td",{parentName:"tr",align:null},"Close the current window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b ,")),(0,o.kt)("td",{parentName:"tr",align:null},"Rename the current window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b w")),(0,o.kt)("td",{parentName:"tr",align:null},"Show the window navigator")))),(0,o.kt)("p",null,"The 'rename window' is very useful if you have a lot of windows and want to give each one a descriptive name. Remember, Tmux is stateful so will remember these settings even if you detached and later re-attach (we'll see this in the next section)."),(0,o.kt)("h3",{id:"session-management"},"Session Management"),(0,o.kt)("p",null,"Sessions in Tmux are a collection of independently managed windows. They are great for creating lots of 'projects' - each session can be a project with the appropriate windows for the work you are doing."),(0,o.kt)("p",null,"Let's start Tmux, but name the session ",(0,o.kt)("inlineCode",{parentName:"p"},"effective-shell")," by using the ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux new -s effective-shell")," command. Once we've done this, we'll create a couple of windows, then create a new session by using ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+b :"),". This command opens the Tmux command pane which is shown at the bottom of the screen. This command pane allows us to run a Tmux command. When we do this, we don't need to put ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux")," at the beginning. Let's create a second session named ",(0,o.kt)("inlineCode",{parentName:"p"},"my-project"),". We can now switch between sessions with ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+b s"),". This opens the list of sessions and lets us select one using the arrow keys. Tmux gives us a preview of each session as we move the selection over them."),(0,o.kt)("p",null,"The commands we will run are below. Remember, ",(0,o.kt)("inlineCode",{parentName:"p"},"^B")," means 'Control B', i.e. hold the Ctrl key and press 'b':"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# Create a new tmux session with the name 'effective shell'.\ntmux new -s effective-shell\n\n# Create a new Window.\n^B c\n\n# Enter tmux command mode.\n^B :\n\n# Create a second session.\nnew -s my-project\n\n# Select from the list of sessions.\n^B s\n")),(0,o.kt)("p",null,"We can see visually what this looks like below:"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484171.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("h3",{id:"attaching-and-detaching-from-sessions"},"Attaching and Detaching from Sessions"),(0,o.kt)("p",null,"The great thing about sessions is that we can set them up, then detach from them to do other work. The sessions will keep running and we can re-attach to them later. This means you can close your terminal and re-open it and programs will still run."),(0,o.kt)("p",null,"If we are in the shell and want to open Tmux and attach to whatever was the last session, we can just run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"tmux attach\n")),(0,o.kt)("p",null,"When we are in a Tmux session, we can detach from it by entering command mode with ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl+B :")," and using the ",(0,o.kt)("inlineCode",{parentName:"p"},"detach")," command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"^B :\ndetach\n")),(0,o.kt)("p",null,"We could close our terminal at this point - the sessions are persisted by the Tmux server. Now if we re-open a terminal, we can re-attach with the same command as before:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"tmux attach\n")),(0,o.kt)("p",null,"A video of how this looks is below:"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484178.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("p",null,"If you use Tmux a lot you might find you end up with lots of sessions - you can delete sessions by pressing ",(0,o.kt)("inlineCode",{parentName:"p"},"^B s")," to show the session list, scroll to the session you want to delete and just press ",(0,o.kt)("inlineCode",{parentName:"p"},"x"),". Tmux will ask for confirmation before it closes the session."),(0,o.kt)("p",null,"Some useful shortcuts for sessions are:"),(0,o.kt)("p",null,"Sessions are extremely powerful for organising your work. Some useful commands for working with sessions are:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Command"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux attach")),(0,o.kt)("td",{parentName:"tr",align:null},"Attach to the last used session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux new -s name")),(0,o.kt)("td",{parentName:"tr",align:null},"Start a new ",(0,o.kt)("inlineCode",{parentName:"td"},"tmux")," session named ",(0,o.kt)("inlineCode",{parentName:"td"},"name"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b : new -s another-name")),(0,o.kt)("td",{parentName:"tr",align:null},"Enter command mode, start session named ",(0,o.kt)("inlineCode",{parentName:"td"},"another-name"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b $")),(0,o.kt)("td",{parentName:"tr",align:null},"Rename the current session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b s")),(0,o.kt)("td",{parentName:"tr",align:null},"Show the session list. Close the selected session with ",(0,o.kt)("inlineCode",{parentName:"td"},"x"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b )")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to next session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b (")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the previous session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b w")),(0,o.kt)("td",{parentName:"tr",align:null},"Show all windows - this command also shows all sessions!")))),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"Tmux's out-of-the-box configuration is normally going to be fine for everyday use. However, if you find yourself using Tmux a lot you might want to look at some of the configuration options available to help you fine-tune the program to suit your preferences."),(0,o.kt)("p",null,"Tmux follows a very standard Unix-style configuration pattern - a dotfile is used to configure the program. If you are not familiar with dotifles, check ",(0,o.kt)("a",{parentName:"p",href:"/part-5-building-your-toolkit/managing-your-dotfiles"},"Chapter 26 - Managing Your Dotfiles")," - this chapter also goes into detail on how you can version control and save your dotfiles as well as share them across many machines easily."),(0,o.kt)("p",null,"To configure Tmux, create a file named ",(0,o.kt)("inlineCode",{parentName:"p"},".tmux.conf")," in your home directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"touch ~/.tmux.conf\n")),(0,o.kt)("p",null,"Now open this file in your preferred editor. As we have just created it there will be nothing in the file."),(0,o.kt)("p",null,"There are a raft of configuration options available, you can check the manpages with ",(0,o.kt)("inlineCode",{parentName:"p"},"man tmux")," to see details, or search for any of the excellent online guides on how to configure Tmux. I'll share what I think are some of the most useful configuration options for Tmux",(0,o.kt)("sup",{parentName:"p",id:"fnref-1"},(0,o.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1")),"."),(0,o.kt)("p",null,"Let's add some configuration options, I'll explain each as we go along."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"The Default Shell")),(0,o.kt)("p",null,"The first thing I do is to tell Tmux to use my current shell program. This means if I am using Z-Shell, Tmux will open windows with Z-Shell. If I am using Bash, it will use Bash. It will also source my shell dotfiles, so that each window that is opened has the same PS1 and configuration as my standard shell."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Set the default shell, and set the default command to use our shell (this\n# means we source things properly, show the correct PS1 etc).\nset -g default-shell ${SHELL}\nset -g default-command ${SHELL}\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Open windows in the Working Directory")),(0,o.kt)("p",null,"By default when you create a new window with ",(0,o.kt)("inlineCode",{parentName:"p"},"^B c"),", Tmux will set the working directory of the window to the home directory. In general I prefer to have the window open in my current working directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# Open new panes and splits in the same working directory.\nbind c new-window -c "#{pane_current_path}"\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Stable window names and sequential windows")),(0,o.kt)("p",null,"Tmux will try to be smart and change the name of each window to the program it is currently running. This means window names change as you use them. I find this distracting, so disable the automatic renaming of windows - in general I rename a window as soon as I have opened it with ",(0,o.kt)("inlineCode",{parentName:"p"},"^B ,")," and give it a descriptive name."),(0,o.kt)("p",null,"I also set Tmux to start windows from number 1 rather than 0, and when windows are created or deleted ensure that Tmux re-numbers them so that they are sequential, without gaps. If you don't do this you'll rapidly find yourself running into windows with double-digit numbers which are harder to select (you can only use ",(0,o.kt)("inlineCode",{parentName:"p"},"^B <window-number")," to select windows 0 through 9):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Set the name of the window initially, but then don't let tmux change it.\n# The name can still be set at any time with Ctrl+B + ,\nset-option -g allow-rename off\n\n# Start windows and panes at 1.\nset -g base-index 1\nset -g pane-base-index 1\n\n# When we add/remove windows, renumber them in sequential order.\nset -g renumber-windows on\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Sensible Splitting Commands")),(0,o.kt)("p",null,"I've always found ",(0,o.kt)("inlineCode",{parentName:"p"},"^B %")," and ",(0,o.kt)("inlineCode",{parentName:"p"},'^B "')," odd commands to split, and still to this day regularly mix them up. So I use ",(0,o.kt)("inlineCode",{parentName:"p"},"^B -")," to make a vertical split and ",(0,o.kt)("inlineCode",{parentName:"p"},"^B |")," t make a horizontal split. The direction of the bar, either the hyphen or vertical bar I find much easier as a way to remember what kind of split I'll be making!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# Split panes using | and -\nbind | split-window -h -c "#{pane_current_path}"\nbind - split-window -v -c "#{pane_current_path}"\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Nested Session Leaders")),(0,o.kt)("p",null,"I am almost never not in a Tmux session. This means that if I open a ",(0,o.kt)("em",{parentName:"p"},"nested")," session, for example by ssh-ing into a virtual machine that and running Tmux there, I have trouble sending commands to the nested Tmux - if I use ",(0,o.kt)("inlineCode",{parentName:"p"},"^b c")," to open a new window for example, it'll open the window on my machine, not in the nested session. By using ",(0,o.kt)("inlineCode",{parentName:"p"},"bind-key v send-prefix")," I can use ",(0,o.kt)("inlineCode",{parentName:"p"},"^b b")," to send a command to the nested session. This might sound fiddly but we'll see how useful it is in the next section!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Use ^b b to send the leader to a nested session. This means if you are\n# using tmux and then ssh into a tmux session (i.e. a nested session) you\n# can run commands in the nested session with ^B b <command>.\nbind-key b send-prefix\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Mouse Support")),(0,o.kt)("p",null,"If you have a mouse, which will normally be the case if you are working with your local machine, then you can enable the mouse for Tmux, allowing you to drag panes to resize them, select panes and windows with the mouse and so on."),(0,o.kt)("p",null,"If you are feeling like you want to really get your 'mouseless' flow working - disable this option! It'll force you to learn the commands."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Enable mouse mode (tmux 2.1 and above)\nset -g mouse on\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Vim Mode!")),(0,o.kt)("p",null,"I set a number of configuration options to help Tmux interface more seamlessly with Vim, and also use Vim directions rather than arrow keys to move around. This means I use ",(0,o.kt)("inlineCode",{parentName:"p"},"^B j")," to go to the pane below, ",(0,o.kt)("inlineCode",{parentName:"p"},"^B l")," to go to the pane to the right."),(0,o.kt)("p",null,"I have also configured a number of keybindings to make resizing panes a little more intuitive to a Vim user, as well as keybindings for Vim style selection of text."),(0,o.kt)("p",null,"These are more advanced options and only going to be of interest to Vim users however, so I'll let you explore them if you are interested in my dotfiles project at ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/dwmkerr/dotfiles"},"github.com/dwmkerr/dotfiles")),(0,o.kt)("h3",{id:"advanced-configuration"},"Advanced Configuration"),(0,o.kt)("p",null,"We have really only touched the most basic of configuration options. Tmux can be customised in almost any way imaginable."),(0,o.kt)("p",null,"The visual style of the status bar, the colours, the information shown, all of these settings can be changed. There are also plugin-managers for Tmux to make it easier to install plugins that provide more advanced configurations."),(0,o.kt)("p",null,"This is a more advanced topic and one I would only suggest exploring once you are familiar with 'vanilla' Tmux!"),(0,o.kt)("h2",{id:"collaboration"},"Collaboration"),(0,o.kt)("p",null,"So far we have run all of our sessions on our local machine. This is great for organising your local work. But you can run Tmux on another machine or server, then connect to it from your machine."),(0,o.kt)("p",null,"This is another quite advanced topic, but to show just how powerful this can be, the video below demonstrates some of Tmux's features and how they can make working across many machines so much easier."),(0,o.kt)("p",null,"In this video, the following actions are performed:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"We start a local Tmux session with ",(0,o.kt)("inlineCode",{parentName:"li"},"tmux")),(0,o.kt)("li",{parentName:"ol"},"We split the window, giving us space to open a secure shell, using ",(0,o.kt)("inlineCode",{parentName:"li"},"^b %")),(0,o.kt)("li",{parentName:"ol"},"In our new split, we ssh onto the box we created in ",(0,o.kt)("a",{parentName:"li",href:"/part-6-advanced-techniques/the-secure-shell/"},"Chapter 31 - The Secure Shell")),(0,o.kt)("li",{parentName:"ol"},"On this box, we start a new Tmux session"),(0,o.kt)("li",{parentName:"ol"},"In this Tmux session we start creating a new Python script"),(0,o.kt)("li",{parentName:"ol"},"Now we connect to this session from our local machine over ssh using ",(0,o.kt)("inlineCode",{parentName:"li"},"ssh -t effective-shell-aws-linux tmux attach")),(0,o.kt)("li",{parentName:"ol"},"This attaches us to our session on the server - and we're in Vim ready to work on the script!"),(0,o.kt)("li",{parentName:"ol"},"To complete the demo, I connect from ",(0,o.kt)("em",{parentName:"li"},"another")," machine, my Macbook - and then edit the script live")),(0,o.kt)("p",null,"In this demo we have two separate machines connecting to our server, able to collaborate real-time on a Tmux session that will persist even if we shut down the machines we are connecting from. This just touches the surface of what is possible!"),(0,o.kt)(i.Z,{style:{width:"800px"},src:"/casts/484227.cast",poster:"npt:0:23",autoPlay:!0,preload:!0,mdxType:"AsciinemaPlayer"}),(0,o.kt)("p",null,"In this example we used the command ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh -t effective-shell-aws-linux tmux attach"),". The ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh")," program allows you to run a command on the server. The command we are running is ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux attach"),". Now by default if we ask ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh")," to run a command it will not connect the input of our terminal to the server - the idea is that sometimes we are just using ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh")," to run one-off commands and don't need to stay connected. But for this command we actually want to stay attached to the server, so we use the ",(0,o.kt)("inlineCode",{parentName:"p"},"-t")," ",(0,o.kt)("em",{parentName:"p"},"request tty`")," flag to attach our terminal input to the SSH session."),(0,o.kt)("p",null,"You can setup your SSH config file to automatically attach to the Tmux session. This is how my ",(0,o.kt)("em",{parentName:"p"},"~/.ssh/config")," file entry is setup for the virtual machine we created in ",(0,o.kt)("a",{parentName:"p",href:"/part-6-advanced-techniques/the-secure-shell/"},"Chapter 31 - The Secure Shell"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Host effective-shell-aws-linux\n  HostName ec2-13-213-71-135.ap-southeast-1.compute.amazonaws.com\n  User ec2-user\n  IdentityFile ~/.ssh/effective-shell\n  RequestTTY yes # ensure that we attach our terminal input\n  RemoteCommand tmux attach # attach to the tmux session\n")),(0,o.kt)("p",null,"This configuration means that when we SSH onto the ",(0,o.kt)("em",{parentName:"p"},"effective-shell-aws-linux")," box we will run the ",(0,o.kt)("inlineCode",{parentName:"p"},"tmux attach")," command and attach our terminal. To connect to Tmux on the server now we only need to run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"ssh effective-shell-aws-linux\n")),(0,o.kt)("h2",{id:"going-further-with-tmux"},"Going Further with Tmux"),(0,o.kt)("p",null,"We've really only touched the surface of what Tmux can do. There are some truly incredible things you can do with a multiplexer like Tmux as you start to use it more. Selecting text from the shell without touching the mouse, seamless integration of Tmux splits and Vim splits, sending commands to multiple machines at once, using plugin managers to add advanced features, the list goes on."),(0,o.kt)("p",null,"Tmux also lets you rapidly resize panes, break a pane into its own window or session, re-order panes, swap panes and so on. These commands are probably the next ones to start becoming familiar with! If you have enabled mouse mode you can also resize panes with the mouse if you have one available."),(0,o.kt)("p",null,"I'd highly recommend using Tmux as part of your standard workflow - get familiar with the basic features shown in this chapter and then as you start to find limitations and want to do more explore some of the great books and blog posts out there that go into more advanced features."),(0,o.kt)("h2",{id:"getting-help"},"Getting Help"),(0,o.kt)("p",null,"You can quickly see all of the Tmux commands by running ",(0,o.kt)("inlineCode",{parentName:"p"},"^b ?"),". The output of this command will look something like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"C-b C-b     Send the prefix key\nC-b C-o     Rotate through the panes\nC-b C-z     Suspend the current client\nC-b Space   Select next layout\nC-b !       Break pane to a new window\nC-b \"       Split window vertically\nC-b #       List all paste buffers\nC-b $       Rename current session\nC-b %       Split window horizontally\nC-b &       Kill current window\nC-b '       Prompt for window index to select\nC-b (       Switch to previous client\nC-b )       Switch to next client\nC-b ,       Rename current window\nC-b .       Move the current window\nC-b /       Describe key binding\nC-b 0       Select window 0\nC-b 1       Select window 1\n...\n")),(0,o.kt)("p",null,"A quick reference of command commands below:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Command"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"Essential Tmux Commands")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux ls")),(0,o.kt)("td",{parentName:"tr",align:null},"List sessions")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux new [-s name]")),(0,o.kt)("td",{parentName:"tr",align:null},"Start a new ",(0,o.kt)("inlineCode",{parentName:"td"},"tmux")," (optionally with a session name)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux attach [-t name]")),(0,o.kt)("td",{parentName:"tr",align:null},"Attach to the last used session, or the target session with ",(0,o.kt)("inlineCode",{parentName:"td"},"-t"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux kill-session [-t name]")),(0,o.kt)("td",{parentName:"tr",align:null},"Kill a session named ",(0,o.kt)("inlineCode",{parentName:"td"},"name"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"tmux kill-session -a")),(0,o.kt)("td",{parentName:"tr",align:null},"Kill all sessions ",(0,o.kt)("em",{parentName:"td"},"except")," the current session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b d")),(0,o.kt)("td",{parentName:"tr",align:null},"Detach from the current session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b : new -s another-name")),(0,o.kt)("td",{parentName:"tr",align:null},"Enter command mode, start session named ",(0,o.kt)("inlineCode",{parentName:"td"},"another-name"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b ?")),(0,o.kt)("td",{parentName:"tr",align:null},"Show command help")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"*",(0,o.kt)("em",{parentName:"td"},"Sessions")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b $")),(0,o.kt)("td",{parentName:"tr",align:null},"Rename the current session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b s")),(0,o.kt)("td",{parentName:"tr",align:null},"Show the session list. Close the selected session with ",(0,o.kt)("inlineCode",{parentName:"td"},"x"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b )")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to next session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b (")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the previous session")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b w")),(0,o.kt)("td",{parentName:"tr",align:null},"Show all windows - this command also shows all sessions!")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"Windows")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b n")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the next window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b p")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the previous window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b 0")),(0,o.kt)("td",{parentName:"tr",align:null},"Select the window numbered '0' - use the number of any window from the status pane")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b &")),(0,o.kt)("td",{parentName:"tr",align:null},"Close the current window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b ,")),(0,o.kt)("td",{parentName:"tr",align:null},"Rename the current window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b w")),(0,o.kt)("td",{parentName:"tr",align:null},"Show the window navigator")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b $")),(0,o.kt)("td",{parentName:"tr",align:null},"Kill the current window")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"Splits and Panes")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b %")),(0,o.kt)("td",{parentName:"tr",align:null},"Create a horizontal split")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},'^b "')),(0,o.kt)("td",{parentName:"tr",align:null},"Create a vertical split")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b <arrow>")),(0,o.kt)("td",{parentName:"tr",align:null},"Move to the pane in the direction of an arrow key")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b z")),(0,o.kt)("td",{parentName:"tr",align:null},"Zoom in or out of a pane")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"^b !")),(0,o.kt)("td",{parentName:"tr",align:null},"Convert pane to window")))),(0,o.kt)("h2",{id:"going-further-with-tmux-1"},"Going Further with Tmux"),(0,o.kt)("p",null,"To learn more about Tmux I recommend the excellent book ",(0,o.kt)("a",{parentName:"p",href:"https://www.amazon.sg/gp/product/1680502212/ref=ppx_yo_dt_b_asin_title_o03_s00?ie=UTF8&psc=1"},"tmux 2: Productive Mouse-Free Development")," by Brian Hogen. This is suitable for anyone, from beginner to expert, you can regularly go back to it as you become more familiar with the basics of Tmux and learn how to take your skills to the next level!"),(0,o.kt)("h2",{id:"summary"},"Summary"),(0,o.kt)("p",null,"In this chapter we introduced the concept of Terminal Multiplexers, in particular GNU screen and Tmux. We saw how to manage windows, panes and sessions. We learned how to configure Tmux to suit your personal working style. We also looked at how we can use Tmux to manage sessions on remote machines and even collaborate real time with other users."),(0,o.kt)("div",{className:"footnotes"},(0,o.kt)("hr",{parentName:"div"}),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol",id:"fn-1"},"You can find my complete set of dotfiles at ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/dwmkerr/dotfiles"},"github.com/dwmkerr/dofiles")," if you would like to see how I configure other programs.",(0,o.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))}p.isMDXComponent=!0},8113:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/multiplexer-screenshot-d99b6247558814ee9dc6842816d70257.png"}}]);