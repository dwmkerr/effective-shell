"use strict";(self.webpackChunkeffective_shell=self.webpackChunkeffective_shell||[]).push([[2724],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>d});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(t),h=a,d=u["".concat(l,".").concat(h)]||u[h]||m[h]||i;return t?r.createElement(d,s(s({ref:n},c),{},{components:t})):r.createElement(d,s({ref:n},c))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=h;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[u]="string"==typeof e?e:a,s[1]=o;for(var p=2;p<i;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},8797:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>k,contentTitle:()=>v,default:()=>w,frontMatter:()=>d,metadata:()=>f,toc:()=>g});var r=t(7462),a=t(7294),i=t(3905);const s="container_h9NR",o="gif_Gi8D",l="footer_xxYF",p="credit_ACDL",c="toggle_X02h",u="prompt_cdoD",m="promptHeader_yTzv",h=e=>{let{src:n,alt:t,children:r}=e;const[i,h]=(0,a.useState)(!1);return a.createElement("div",{className:s},i?a.createElement("div",{className:u},a.createElement("div",{className:m},"This is the prompt used to generate this recording with"," ",a.createElement("a",{href:"https://github.com/dwmkerr/shellwright",target:"_blank",rel:"noopener noreferrer"},"Shellwright"),"."),r):a.createElement("img",{src:n,alt:t||"Shell recording",className:o}),a.createElement("div",{className:l},r&&a.createElement(a.Fragment,null,a.createElement("span",{className:p},"Generated with"," ",a.createElement("a",{href:"https://github.com/dwmkerr/shellwright",target:"_blank",rel:"noopener noreferrer"},"Shellwright")),a.createElement("button",{className:c,onClick:()=>h(!i)},i?"Show recording":"Show prompt"))))},d={title:"sourceenv"},v="Source Environment Variables",f={unversionedId:"sourceenv/index",id:"sourceenv/index",title:"sourceenv",description:"The sourceenv function sources environment variables from .env files into your current shell session. These .env files are commonly used in software engineering projects to keep track of environment variables. You might see .env.example showing you what values you should set (like this) and then instruct users to copy this file to .env and fill with the real values - this file is then normally git ignored.",source:"@site/snippets/sourceenv/index.mdx",sourceDirName:"sourceenv",slug:"/sourceenv/",permalink:"/pr-preview/pr-411/shell-snippets/sourceenv/",draft:!1,editUrl:"https://github.com/dwmkerr/effective-shell/edit/main/snippets/sourceenv/index.mdx",tags:[],version:"current",frontMatter:{title:"sourceenv"},sidebar:"snippetsSidebar",previous:{title:"Shell Snippets",permalink:"/pr-preview/pr-411/shell-snippets/"}},k={},g=[{value:"The Code",id:"the-code",level:2},{value:"Installation",id:"installation",level:2}],b={toc:g};function w(e){let{components:n,...a}=e;return(0,i.kt)("wrapper",(0,r.Z)({},b,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"source-environment-variables"},"Source Environment Variables"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"sourceenv")," function sources environment variables from ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," files into your current shell session. These ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," files are commonly used in software engineering projects to keep track of environment variables. You might see ",(0,i.kt)("inlineCode",{parentName:"p"},".env.example")," showing you what values you should set (",(0,i.kt)("a",{parentName:"p",href:"https://github.com/mckinsey/agents-at-scale-ark/blob/main/services/ark-api/.env.example"},"like this"),") and then instruct users to copy this file to ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," and fill with the real values - this file is then normally git ignored."),(0,i.kt)("p",null,"Many services and tools will read these files by default (there are libraries for ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/dotenv"},"node"),", ",(0,i.kt)("a",{parentName:"p",href:"https://pypi.org/project/python-dotenv/"},"python")," and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/search?q=dotenv&type=repositories"},"almost anything else"),"). The ",(0,i.kt)("inlineCode",{parentName:"p"},"sourceenv")," snippet works in a very similar way - it simply sets these values in your current shell session."),(0,i.kt)(h,{src:t(1394).Z,alt:"sourceenv demo",mdxType:"ShellwrightRecording"},(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Create a shell recording using shellwright for the sourceenv snippet:")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Setup")," (before recording starts):"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Start shell in: ",(0,i.kt)("inlineCode",{parentName:"li"},"snippets/snippets/sourceenv/project/")),(0,i.kt)("li",{parentName:"ul"},"Set simple PS1: ",(0,i.kt)("inlineCode",{parentName:"li"},"set_ps1 dwmkerr_simple")),(0,i.kt)("li",{parentName:"ul"},"Clear the screen"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Recording settings:")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Terminal size: 80x20"),(0,i.kt)("li",{parentName:"ul"},"FPS: 10"),(0,i.kt)("li",{parentName:"ul"},"Use typewriter-style keystroke entry"),(0,i.kt)("li",{parentName:"ul"},"Wait 2 seconds between commands"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Commands to record:")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ls -al")," (show .env files)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cat .env")," (show contents)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"clear")," (execute quickly, no typewriter)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sourceenv")," (shows 4 vars set)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sourceenv .env.prod")," (shows 2 updated, 2 new)"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Save recording to:")," ",(0,i.kt)("inlineCode",{parentName:"p"},"snippets/snippets/sourceenv/sourceenv.gif"))))),(0,i.kt)("p",null,"You can run ",(0,i.kt)("inlineCode",{parentName:"p"},"sourceenv")," like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Just source whatever is in .env in the current directory.\nsourceenv\n\n# Source a specific file.\nsourceenv .env.prod\n\n# Source in verbose mode, which shows the actual values being set. Use with\n# caution as this will write what might be sensitive values to stdout.\nsourceenv -v\n")),(0,i.kt)("p",null,"The function shows feedback as it works:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"sourceenv output",src:t(4803).Z,width:"1048",height:"443"})),(0,i.kt)("h2",{id:"the-code"},"The Code"),(0,i.kt)("p",null,"Find the original code in my ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/dwmkerr/dotfiles/blob/main/shell.functions.d/sourceenv.sh"},"dotfiles"),". It is shown below with much more extensive documentation and explanation!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="https://github.com/dwmkerr/dotfiles/blob/main/shell.functions.d/sourceenv.sh"',title:'"https://github.com/dwmkerr/dotfiles/blob/main/shell.functions.d/sourceenv.sh"'},'sourceenv() {\n  local name="sourceenv"\n  local verbose=false\n\n  # Parse the command line arguments using a case statement.\n  # Read more in the chapter "Shell Script Essentials".\n  while [[ $# -gt 0 ]]; do\n    case $1 in\n      -h)\n        echo "usage: ${name} [-v] [<path_to_env_file>]"\n        echo "  Sources environment variable definitions from a .env file, e.g:"\n        echo "  KEY=VALUE"\n        echo "  -v  verbose mode (show values being set)"\n        exit 0\n        ;;\n      -v)\n        verbose=true\n        shift\n        ;;\n      *)\n        env_file="$1"\n        shift\n        ;;\n    esac\n  done\n\n  # Default to \'.env\' in the current directory if no file was specified.\n  # Read more in the chapter "Variables, Reading Input, and Mathematics".\n  env_file="${env_file:-.env}"\n\n  if [ ! -f "$env_file" ]; then\n    echo "error: ${env_file} not found"\n    echo "usage: ${name} [-v] [<path_to_env_file>]"\n  else\n    # Read the file line-by-line. The \'|| [ -n "$line" ]\' ensures we process\n    # the last line even if it doesn\'t end with a newline.\n    while IFS= read -r line || [ -n "$line" ]; do\n      # Skip empty lines and lines that start with a comment.\n      [[ -z "$line" || "$line" =~ ^[[:space:]]*# ]] && continue\n\n      # Strip inline comments. The regex captures everything before a \'#\' that\n      # isn\'t followed by quoted content.\n      if [[ "$line" =~ ^([^#]*[^[:space:]])([[:space:]]*#.*)?$ ]]; then\n        line="${BASH_REMATCH[1]}"\n      fi\n\n      # Match lines that look like \'KEY=value\'. The regex ensures the variable\n      # name starts with a letter or underscore.\n      if [[ "$line" =~ ^([A-Za-z_][A-Za-z0-9_]*)=(.*)$ ]]; then\n        var_name="${BASH_REMATCH[1]}"\n        var_value="${BASH_REMATCH[2]}"\n\n        # Strip surrounding quotes (single or double) from the value.\n        if [[ "$var_value" =~ ^\\"(.*)\\"$ ]] || [[ "$var_value" =~ ^\\\'(.*)\\\'$ ]]; then\n          var_value="${BASH_REMATCH[1]}"\n        fi\n\n        # Show the user whether we\'re setting a new variable or updating an\n        # existing one. The \'${!var_name:-}\' syntax checks if the variable is\n        # already set. Blue for updates, green for new variables.\n        # Read more in the chapter "Customising Your Command Prompt".\n        if [[ -n "${!var_name:-}" ]]; then\n          if [[ "$verbose" == true ]]; then\n            echo -e "\\033[34m${var_name}\\033[0m: updated ($var_value)"\n          else\n            echo -e "\\033[34m${var_name}\\033[0m: updated"\n          fi\n        else\n          if [[ "$verbose" == true ]]; then\n            echo -e "\\033[32m${var_name}\\033[0m: set ($var_value)"\n          else\n            echo -e "\\033[32m${var_name}\\033[0m: set"\n          fi\n        fi\n\n        # Export the variable so it\'s available to child processes.\n        export "${var_name}=${var_value}"\n      fi\n    done < "$env_file"\n  fi\n}\n')),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"Add the function to your shell configuration (e.g., ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.bashrc")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.zshrc"),"), or if you use a dotfiles setup, place it in a file that gets sourced on shell startup."),(0,i.kt)("p",null,"The latest version is available in my ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/dwmkerr/dotfiles/blob/main/shell.functions.d/sourceenv.sh"},"dotfiles"),"."))}w.isMDXComponent=!0},1394:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/sourceenv-014445428efdb7c23d274d26b640e3e4.gif"},4803:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/sourceenv-prod-38c963083e3a10d5dc7b8b38b120b3b1.png"}}]);